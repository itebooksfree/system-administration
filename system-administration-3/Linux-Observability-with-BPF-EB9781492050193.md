![Cover image for Linux Observability with BPF](https://imgdetail.ebookreading.net/cover/cover/system_admin/EB9781492050193.jpg)

[Linux Observability with BPF](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_1.html "Linux Observability with BPF")
====================================================================================================================

Author : [Lorenzo Fontana](https://ebookreading.net/search/author/Lorenzo+Fontana),[ David Calavera](https://ebookreading.net/search/author/+David+Calavera)

Release Date : 2019/10/01

ISBN : 9781492050193

Topic : [System Administration](https://ebookreading.net/search/category/system-administration)

Book Description
-----------------

 Build your expertise in the BPF virtual machine in the Linux kernel with this practical guide for systems engineers. You’ll not only dive into the BPF program lifecycle but also learn to write applications that observe and modify the kernel’s behavior; inject code to monitor, trace, and securely observe events in the kernel; and more.
Authors David Calavera and Lorenzo Fontana help you harness the power of BPF to make any computing system more observable. Familiarize yourself with the essential concepts you’ll use on a day-to-day basis and augment your knowledge about performance optimization, networking, and security. Then see how it all comes together with code examples in C, Go, and Python.
Write applications that use BPF to observe and modify the Linux kernel’s behavior on demandInject code to monitor, trace, and observe events in the kernel in a secure way—no need to recompile the kernel or reboot the systemExplore code examples in C, Go, and PythonGain a more thorough understanding of the BPF program lifecycle        Show and hide more                
Table of Contents
-----------------

1. [Foreword](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_4.html#idm46623568808504)
1. [Preface](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_5.html#idm46623568455528)
    1. [Conventions Used in This Book](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_5.html#idm46623568726680)
    1. [Using Code Examples](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_5.html#idm46623567285592)
    1. [O’Reilly Online Learning](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_5.html#idm46623568627016)
    1. [How to Contact Us](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_5.html#idm46623568620808)
    1. [Acknowledgments](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_5.html#idm46623568644312)
1. [1. Introduction](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_6.html#introduction)
    1. [BPF’s History](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_6.html#idm46623568449624)
    1. [Architecture](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_6.html#idm46623568449064)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_6.html#idm46623568415064)
1. [2. Running Your First BPF Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#running_your_first_)
    1. [Writing BPF Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623568851992)
    1. [BPF Program Types](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623568851368)
        1. [Socket Filter Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561545288)
        1. [Kprobe Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561540920)
        1. [Tracepoint Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561533528)
        1. [XDP Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561526680)
        1. [Perf Event Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561519608)
        1. [Cgroup Socket Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561515960)
        1. [Cgroup Open Socket Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561509880)
        1. [Socket Option Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561506472)
        1. [Socket Map Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561499400)
        1. [Cgroup Device Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561495528)
        1. [Socket Message Delivery Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561492008)
        1. [Raw Tracepoint Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561461112)
        1. [Cgroup Socket Address Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561457592)
        1. [Socket Reuseport Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561454040)
        1. [Flow Dissection Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561448968)
        1. [Other BPF Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561444520)
    1. [The BPF Verifier](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561554024)
    1. [BPF Type Format](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561427784)
    1. [BPF Tail Calls](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561339864)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_7.html#idm46623561333160)
1. [3. BPF Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#bpf_maps)
    1. [Creating BPF Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623561324744)
        1. [ELF Conventions to Create BPF Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623561170440)
    1. [Working with BFP Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623561169816)
        1. [Updating Elements in a BPF Map](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623561027256)
        1. [Reading Elements from a BPF Map](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623561026600)
        1. [Removing an Element from a BPF Map](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623560625832)
        1. [Iterating Over Elements in a BPF Map](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623560265912)
        1. [Looking Up and Deleting Elements](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623560265320)
        1. [Concurrent Access to Map Elements](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559828824)
    1. [Types of BPF Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559828200)
        1. [Hash-Table Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559585608)
        1. [Array Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559393592)
        1. [Program Array Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559384616)
        1. [Perf Events Array Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559384024)
        1. [Per-CPU Hash Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559157624)
        1. [Per-CPU Array Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558952552)
        1. [Stack Trace Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558947112)
        1. [Cgroup Array Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558941656)
        1. [LRU Hash and Per-CPU Hash Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558852952)
        1. [LPM Trie Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558791000)
        1. [Array of Maps and Hash of Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558790408)
        1. [Device Map Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558505432)
        1. [CPU Map Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558498984)
        1. [Open Socket Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558493672)
        1. [Socket Array and Hash Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558489016)
        1. [Cgroup Storage and Per-CPU Storage Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558481032)
        1. [Reuseport Socket Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558381016)
        1. [Queue Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558375240)
        1. [Stack Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558374648)
    1. [The BPF Virtual Filesystem](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623559589240)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_8.html#idm46623558000664)
1. [4. Tracing with BPF](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#tracing_with_bpf)
    1. [Probes](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#probes-section)
        1. [Kernel Probes](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623557534856)
        1. [Tracepoints](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623557021352)
        1. [User-Space Probes](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#uprobes)
        1. [User Statically Defined Tracepoints](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623556761160)
    1. [Visualizing Tracing Data](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623557976344)
        1. [Flame Graphs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623555867896)
        1. [Histograms](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623555866984)
        1. [Perf Events](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623555238152)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_9.html#idm46623554949016)
1. [5. BPF Utilities](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#bpf_utilities)
    1. [BPFTool](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554639928)
        1. [Installation](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554635304)
        1. [Feature Display](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554603704)
        1. [Inspecting BPF Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554612824)
        1. [Inspecting BPF Maps](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554611912)
        1. [Inspecting Programs Attached to Specific Interfaces](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554429048)
        1. [Loading Commands in Batch Mode](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554290376)
        1. [Displaying BTF Information](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554278920)
    1. [BPFTrace](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554639336)
        1. [Installation](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554258808)
        1. [Language Reference](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554256136)
        1. [Filtering](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554255480)
        1. [Dynamic Mapping](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554170872)
    1. [kubectl-trace](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554170280)
        1. [Installation](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554075800)
        1. [Inspecting Kubernetes Nodes](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554035288)
    1. [eBPF Exporter](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554046440)
        1. [Installation](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623554041416)
        1. [Exporting Metrics from BPF](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623553977368)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_10.html#idm46623553882168)
1. [6. Linux Networking and BPF](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#linux_networking)
    1. [BPF and Packet Filtering](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623553805720)
        1. [tcpdump and BPF Expressions](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623553767144)
        1. [Packet Filtering for Raw Sockets](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623553766200)
    1. [BPF-Based Traffic Control Classifier](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623553653640)
        1. [Terminology](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623552450360)
        1. [Traffic Control Classifier Program Using cls_bpf](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623552386584)
        1. [Differences Between Traffic Control and XDP](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623552385000)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_11.html#idm46623552555096)
1. [7. Express Data Path](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#express_data_path_X)
    1. [XDP Programs Overview](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623551636872)
        1. [Operation Modes](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623551630392)
        1. [The Packet Processor](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623551587336)
        1. [XDP and iproute2 as a Loader](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623551520632)
    1. [XDP and BCC](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623551201496)
    1. [Testing XDP Programs](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623551188680)
        1. [XDP Testing Using the Python Unit Testing Framework](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623550712184)
    1. [XDP Use Cases](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623550710600)
        1. [Monitoring](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623549784584)
        1. [DDoS Mitigation](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623549779064)
        1. [Load Balancing](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623549773896)
        1. [Firewalling](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623549769176)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_12.html#idm46623549761848)
1. [8. Linux Kernel Security, Capabilities, and Seccomp](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#kernel_security)
    1. [Capabilities](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#idm46623549748904)
    1. [Seccomp](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#idm46623549747960)
        1. [Seccomp Errors](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#idm46623549409464)
        1. [Seccomp BPF Filter Example](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#idm46623549379592)
    1. [BPF LSM Hooks](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#idm46623549509928)
    1. [Conclusion](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_13.html#idm46623548471480)
1. [9. Real-World Use Cases](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_14.html#use_cases)
    1. [Sysdig eBPF God Mode](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_14.html#idm46623548463912)
    1. [Flowmill](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_14.html#idm46623548463000)
1. [Index](https://ebookreading.net/view/book/Linux+Observability+with+BPF-EB9781492050193_15.html#idm46623548318712)
