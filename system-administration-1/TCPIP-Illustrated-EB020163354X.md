![Cover image for TCP/IP Illustrated](https://imgdetail.ebookreading.net/cover/cover/system_admin/EB020163354X.jpg)

[TCP/IP Illustrated](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_1.html "TCP/IP Illustrated")
====================================================================================================================

Author : [W. Richard Stevens](https://ebookreading.net/search/author/W.+Richard+Stevens),[ Gary R. Wright](https://ebookreading.net/search/author/+Gary+R.+Wright)

Release Date : 1995/01/01

ISBN : 020163354X

Topic : [System Administration](https://ebookreading.net/search/category/system-administration)

Book Description
-----------------

TCP/IP Illustrated, an ongoing series covering the many facets of TCP/IP, brings a highly-effective visual approach to learning about this networking protocol suite.
TCP/IP Illustrated, Volume 2 contains a thorough explanation of how TCP/IP protocols are implemented. There isn't a more practical or up-to-date bookothis volume is the only one to cover the de facto standard implementation from the 4.4BSD-Lite release, the foundation for TCP/IP implementations run daily on hundreds of thousands of systems worldwide.
Combining 500 illustrations with 15,000 lines of real, working code, TCP/IP Illustrated, Volume 2 uses a teach-by-example approach to help you master TCP/IP implementation. You will learn about such topics as the relationship between the sockets API and the protocol suite, and the differences between a host implementation and a router. In addition, the book covers the newest features of the 4.4BSD-Lite release, including multicasting, long fat pipe support, window scale, timestamp options, and protection against wrapped sequence numbers, and many other topics.
Comprehensive in scope, based on a working standard, and thoroughly illustrated, this book is an indispensable resource for anyone working with TCP/IP.
              
Table of Contents
-----------------

1. [TCP/IP Illustrated, Volume 2](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_1.html)
    1. [Addison-Wesley Professional Computing Series](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_2.html)
    1. [Preface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_3.html)
        1. [Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_3.html#pref02lev1sec1)
        1. [Organization of the Book](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_3.html#pref02lev1sec2)
        1. [Intended Audience](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_3.html#pref02lev1sec3)
        1. [Source Code Copyright](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_3.html#pref02lev1sec4)
    1. [Acknowledgments](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_4.html)
    1. [Structure Definitions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_5.html)
    1. [Function and Macro Definitions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_6.html)
    1. [1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html)
        1. [1.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec1)
            1. [1.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec1)
            1. [1.2. Source Code Presentation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec2)
                1. [Set congestion window to one segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec1)
                1. [Typographical Conventions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec2)
            1. [1.3. History](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec3)
            1. [1.4. Application Programming Interfaces](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec4)
            1. [1.5. Example Program](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec5)
                1. [Create a datagram socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec3)
                1. [Fill in sockaddr_in structure with serverâ€™s address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec4)
                1. [Send datagram to server](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec5)
                1. [Read datagram returned by server](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec6)
            1. [1.6. System Calls and Library Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec6)
            1. [1.7. Network Implementation Overview](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec7)
            1. [1.8. Descriptors](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec8)
            1. [1.9. Mbufs (Memory Buffers) and Output Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec9)
                1. [Mbuf Containing Socket Address Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec7)
                1. [Mbuf Containing Data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec8)
                1. [Prepending IP and UDP Headers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec9)
                1. [IP Output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec10)
                1. [Ethernet Output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec11)
                1. [Summary of UDP Output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec12)
            1. [1.10. Input Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec10)
                1. [Ethernet Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec13)
                1. [IP Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec14)
                1. [UDP Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec15)
                1. [Process Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev2sec16)
            1. [1.11. Network Implementation Overview Revisited](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec11)
            1. [1.12. Interrupt Levels and Concurrency](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec12)
            1. [1.13. Source Code Organization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec13)
            1. [1.14. Test Network](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec14)
        1. [1.15. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec15)
            1. [1.15. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec15)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_7.html#ch01lev1sec16)
    1. [2. Mbufs: Memory Buffers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html)
        1. [2.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec1)
            1. [2.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec1)
            1. [2.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec2)
                1. [Kernel Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec3)
            1. [2.3. Mbuf Definitions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec3)
            1. [2.4. mbuf Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec4)
            1. [2.5. Simple Mbuf Macros and Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec5)
                1. [m_get Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec4)
                1. [MGET Macro](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec5)
                1. [m_retry Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec6)
                1. [Mbuf Locking](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec7)
            1. [2.6. m_devget and m_pullup Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec6)
                1. [m_devget Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec8)
                1. [mtod and dtom Macros](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec9)
                1. [m_pullup Function and Contiguous Protocol Headers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec10)
                1. [m_pullup and IP Fragmentation and Reassembly](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec11)
                1. [Avoidance of m_pullup by TCP Reassembly](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec12)
                1. [Summary of m_pullup Usage](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev2sec13)
            1. [2.7. Summary of Mbuf Macros and Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec7)
            1. [2.8. Summary of Net/3 Networking Data Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec8)
            1. [2.9. m_copy and Cluster Reference Counts](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec9)
            1. [2.10. Alternatives](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec10)
        1. [2.11. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec11)
            1. [2.11. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec11)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_8.html#ch02lev1sec12)
    1. [3. Interface Layer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html)
        1. [3.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec1)
            1. [3.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec1)
            1. [3.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec1)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec2)
            1. [3.3. ifnet Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec3)
                1. [Common interface information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec3)
                1. [Interface timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec4)
                1. [BSD Packet Filter](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec5)
                1. [Interface characteristics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec6)
                1. [Interface statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec7)
                1. [Change timestamp](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec8)
                1. [Interface functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec9)
            1. [3.4. ifaddr Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec4)
            1. [3.5. sockaddr Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec5)
                1. [sockaddr structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec10)
                1. [osockaddr structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec11)
            1. [3.6. ifnet and ifaddr Specialization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec6)
            1. [3.7. Network Initialization Overview](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec7)
            1. [3.8. Ethernet Initialization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec8)
                1. [le_softc structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec12)
                1. [arpcom structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec13)
                1. [Copy the hardware address from the device](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec14)
                1. [Initialize the ifnet structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec15)
            1. [3.9. SLIP Initialization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec9)
            1. [3.10. Loopback Initialization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec10)
            1. [3.11. if_attach Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec11)
                1. [Resize ifnet_addrs array if necessary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec16)
                1. [Create link-level name and compute size of link-level address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec17)
                1. [The address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec18)
                1. [The mask](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec19)
                1. [ether_ifattach function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev2sec20)
            1. [3.12. ifinit Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec12)
        1. [3.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec13)
            1. [3.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec13)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_9.html#ch03lev1sec14)
    1. [4. Interfaces: Ethernet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html)
        1. [4.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec1)
            1. [4.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec1)
            1. [4.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec3)
            1. [4.3. Ethernet Interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec3)
                1. [leintr Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec4)
                1. [leread Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec5)
                1. [ether_input Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec6)
                1. [Broadcast and multicast recognition](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec7)
                1. [Link-level demultiplexing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec8)
                1. [Queue the packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec9)
                1. [ether_output Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec10)
                1. [Host route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec11)
                1. [Gateway route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec12)
                1. [Avoid ARP flooding](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec13)
                1. [IP output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec14)
                1. [Explicit Ethernet output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec15)
                1. [Unrecognized address families](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec16)
                1. [Ethernet header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec17)
                1. [lestart Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec18)
                1. [Interface must be initialized](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec19)
                1. [Dequeue frame from output queue](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec20)
                1. [Transmit frame and pass to BPF](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec21)
                1. [Repeat if device is ready for more frames](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec22)
                1. [Mark device as busy](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec23)
            1. [4.4. ioctl System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec4)
                1. [ifioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec24)
                1. [ifconf Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec25)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec26)
                1. [Generic Interface ioctl commands](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec27)
                1. [SIOCGIFFLAGS and SIOCGIFMETRIC](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec28)
                1. [SIOCSIFFLAGS](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec29)
                1. [Ignore IFF_CANTCHANGE flags](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec30)
                1. [SIOCSIFMETRIC](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec31)
                1. [if_down and if_up Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec32)
                1. [Ethernet, SLIP, and Loopback](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev2sec33)
        1. [4.5. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec5)
            1. [4.5. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec5)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_10.html#ch04lev1sec6)
    1. [5. Interfaces: SLIP and Loopback](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html)
        1. [5.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec1)
            1. [5.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec1)
            1. [5.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec2)
            1. [5.3. SLIP Interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec3)
                1. [The SLIP Line Discipline: SLIPDISC](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec3)
                1. [SLIP Initialization: slopen and slinit](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec4)
                1. [SLIP Input Processing: slinput](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec5)
                1. [SLIP Output Processing: sloutput](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec6)
                1. [slstart Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec7)
                1. [SLIP Packet Loss](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec8)
                1. [SLIP Performance Considerations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec9)
                1. [slclose Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec10)
                1. [sltioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev2sec11)
            1. [5.4. Loopback Interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec4)
        1. [5.5. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec5)
            1. [5.5. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec5)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_11.html#ch05lev1sec6)
    1. [6. IP Addressing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html)
        1. [6.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec1)
            1. [6.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec1)
                1. [IP Addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec1)
                1. [Typographical Conventions for IP Addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec2)
                1. [Hosts and Routers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec3)
            1. [6.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec4)
            1. [6.3. Interface and Address Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec3)
            1. [6.4. sockaddr_in Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec4)
            1. [6.5. in_ifaddr Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec5)
            1. [6.6. Address Assignment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec6)
                1. [ifioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec5)
                1. [in_control Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec6)
                1. [Preconditions: SIOCSIFADDR, SIOCSIFNETMASK, and SIOCSIFDSTADDR](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec7)
                1. [Superuser only](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec8)
                1. [Allocate structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec9)
                1. [Initialize structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec10)
                1. [Address Assignment: SIOCSIFADDR](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec11)
                1. [in_ifinit Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec12)
                1. [Assign address and notify hardware](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec13)
                1. [Ethernet configuration](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec14)
                1. [Discard previous routes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec15)
                1. [Construct network mask and default subnetmask](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec16)
                1. [Construct network and subnetwork numbers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec17)
                1. [Establish route for host or network](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec18)
                1. [Join all-hosts group](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec19)
                1. [Network Mask Assignment: SIOCSIFNETMASK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec20)
                1. [Destination Address Assignment: SIOCSIFDSTADDR](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec21)
                1. [Retrieving Interface Information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec22)
                1. [Multiple IP Addresses per Interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec23)
                1. [Additional IP Addresses: SIOCAIFADDR](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec24)
                1. [Deleting IP Addresses: SIOCDIFADDR](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec25)
            1. [6.7. Interface ioctl Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec7)
                1. [leioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec26)
                1. [Unrecognized commands](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec27)
                1. [slioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec28)
                1. [Unrecognized commands](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec29)
                1. [loioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec30)
                1. [Unrecognized commands](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev2sec31)
            1. [6.8. Internet Utility Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec8)
            1. [6.9. ifnet Utility Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec9)
        1. [6.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec10)
            1. [6.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec10)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_12.html#ch06lev1sec11)
    1. [7. Domains and Protocols](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html)
        1. [7.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec1)
            1. [7.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec1)
            1. [7.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec2)
            1. [7.3. domain Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec3)
            1. [7.4. protosw Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec4)
            1. [7.5. IP domain and protosw Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec5)
                1. [domaininit Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec3)
            1. [7.6. pffindproto and pffindtype Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec6)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec4)
            1. [7.7. pfctlinput Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec7)
            1. [7.8. IP Initialization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec8)
                1. [Internet Transport Demultiplexing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec5)
                1. [ip_init Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec6)
            1. [7.9. sysctl System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec9)
                1. [net_sysctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev2sec7)
        1. [7.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec10)
            1. [7.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec10)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_13.html#ch07lev1sec11)
    1. [8. IP: Internet Protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html)
        1. [8.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec1)
            1. [8.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec1)
            1. [8.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec3)
            1. [8.3. IP Packets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec3)
            1. [8.4. Input Processing: ipintr Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec4)
                1. [ipintr Overview](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec4)
                1. [Verification](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec5)
                1. [IP version](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec6)
                1. [IP checksum](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec7)
                1. [Byte ordering](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec8)
                1. [Packet length](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec9)
                1. [To Forward or Not To Forward?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec10)
                1. [Option processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec11)
                1. [Final destination?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec12)
                1. [Forwarding](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec13)
                1. [Reassembly and Demultiplexing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec14)
                1. [Transport demultiplexing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec15)
            1. [8.5. Forwarding: ip_forward Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec5)
                1. [Is packet eligible for forwarding?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec16)
                1. [Decrement TTL](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec17)
                1. [Locate next hop](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec18)
                1. [Redirect Messages](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec19)
                1. [Leaving on receiving interface?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec20)
                1. [Send redirect?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec21)
                1. [Select appropriate router](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec22)
                1. [Forward packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec23)
                1. [Send ICMP error?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec24)
            1. [8.6. Output Processing: ip_output Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec6)
                1. [Header Initialization](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec25)
                1. [Construct IP header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec26)
                1. [Packet already includes header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec27)
                1. [Route Selection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec28)
                1. [Verify cached route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec29)
                1. [Bypass routing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec30)
                1. [Locate route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec31)
                1. [Source Address Selection and Fragmentation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec32)
                1. [Select source address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec33)
                1. [Send packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec34)
                1. [Fragment packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec35)
                1. [Cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec36)
            1. [8.7. Internet Checksum: in_cksum Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec7)
                1. [Loop unrolling](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec37)
                1. [More Optimizations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec38)
            1. [8.8. setsockopt and getsockopt System Calls](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec8)
                1. [PRCO_SETOPT Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec39)
                1. [PRCO_GETOPT Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev2sec40)
            1. [8.9. ip_sysctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec9)
        1. [8.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec10)
            1. [8.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec10)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_14.html#ch08lev1sec11)
    1. [9. IP Option Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html)
        1. [9.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec1)
            1. [9.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec1)
            1. [9.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec2)
            1. [9.3. Option Format](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec3)
            1. [9.4. ip_dooptions Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec4)
                1. [EOL and NOP processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec3)
                1. [Source route forwarding](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec4)
                1. [Error handling](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec5)
            1. [9.5. Record Route Option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec5)
                1. [Record address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec6)
                1. [ip_rtaddr Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec7)
                1. [Check IP forwarding cache](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec8)
                1. [Locate route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec9)
                1. [Return route information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec10)
            1. [9.6. Source and Record Route Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec6)
                1. [End of source route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec11)
                1. [Update packet for next hop](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec12)
                1. [Multicast destinations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec13)
                1. [save_rte Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec14)
                1. [ip_srcroute Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec15)
                1. [Allocate mbuf for source route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec16)
            1. [9.7. Timestamp Option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec7)
                1. [Timestamp only](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec17)
                1. [Timestamp and address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec18)
                1. [Timestamp at prespecified addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec19)
                1. [Insert timestamp](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec20)
                1. [iptime Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec21)
            1. [9.8. ip_insertoptions Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec8)
            1. [9.9. ip_pcbopts Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec9)
                1. [Discard previous options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec22)
                1. [Make room for first-hop destination](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec23)
                1. [Scan option list](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec24)
                1. [Rearrange LSRR or SSRR option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec25)
                1. [Cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev2sec26)
            1. [9.10. Limitations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec10)
        1. [9.11. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec11)
            1. [9.11. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec11)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_15.html#ch09lev1sec12)
    1. [10. IP Fragmentation and Reassembly](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html)
        1. [10.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec1)
            1. [10.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec1)
            1. [10.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec2)
            1. [10.3. Fragmentation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec3)
            1. [10.4. ip_optcopy Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec4)
            1. [10.5. Reassembly](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec5)
            1. [10.6. ip_reass Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec6)
                1. [Create reassembly list](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec3)
                1. [Reassembly timeout](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec4)
                1. [Datagram identifiers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec5)
                1. [Reconstruct datagram header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec6)
                1. [Compute packet length](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec7)
            1. [10.7. ip_slowtimo Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec7)
                1. [ip_drain Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev2sec8)
        1. [10.8. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec8)
            1. [10.8. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec8)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_16.html#ch10lev1sec9)
    1. [11. ICMP: Internet Control Message Protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html)
        1. [11.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec1)
            1. [11.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec1)
            1. [11.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec3)
            1. [11.3. icmp Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec3)
            1. [11.4. ICMP protosw Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec4)
            1. [11.5. Input Processing: icmp_input Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec5)
                1. [Static structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec4)
                1. [Validate message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec5)
                1. [Verify checksum](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec6)
                1. [Verify type](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec7)
                1. [Raw ICMP input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec8)
            1. [11.6. Error Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec6)
            1. [11.7. Request Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec7)
                1. [Echo Query: ICMP_ECHO and ICMP_ECHOREPLY](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec9)
                1. [Timestamp Query: ICMP_TSTAMP and ICMP_TSTAMPREPLY](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec10)
                1. [Address Mask Query: ICMP_MASKREQ and ICMP_MASKREPLY](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec11)
                1. [Select subnet mask](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec12)
                1. [Convert to reply](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec13)
                1. [Select destination address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec14)
                1. [Information Query: ICMP_IREQ and ICMP_IREQREPLY](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec15)
                1. [Router Discovery: icmp_routeradvert and icmp_routersolicit](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec16)
            1. [11.8. Redirect Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec8)
                1. [Validate](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec17)
                1. [Update routes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec18)
            1. [11.9. Reply Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec9)
            1. [11.10. Output Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec10)
            1. [11.11. icmp_error Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec11)
            1. [11.12. icmp_reflect Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec12)
                1. [Set destination address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec19)
                1. [Select source address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec20)
                1. [Get reversed source route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec21)
                1. [Add record route and timestamp options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec22)
                1. [Remove original options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec23)
                1. [Send message and cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev2sec24)
            1. [11.13. icmp_send Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec13)
            1. [11.14. icmp_sysctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec14)
        1. [11.15. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec15)
            1. [11.15. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec15)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_17.html#ch11lev1sec16)
    1. [12. IP Multicasting](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html)
        1. [12.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec1)
            1. [12.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec1)
                1. [Well-Known IP Multicast Groups](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec1)
            1. [12.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec2)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec3)
            1. [12.3. Ethernet Multicast Addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec3)
                1. [IP to Ethernet Multicast Address Mapping](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec4)
                1. [IP to Ethernet multicast mapping](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec5)
            1. [12.4. ether_multi Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec4)
                1. [Ethernet multicast addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec6)
                1. [Ethernet multicast lookups](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec7)
            1. [12.5. Ethernet Multicast Reception](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec5)
            1. [12.6. in_multi Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec6)
                1. [IP multicast addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec8)
                1. [IP multicast lookups](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec9)
            1. [12.7. ip_moptions Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec7)
                1. [Multicast options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec10)
            1. [12.8. Multicast Socket Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec8)
            1. [12.9. Multicast TTL Values](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec9)
                1. [The MBONE](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec11)
                1. [Expanding-Ring Search](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec12)
            1. [12.10. ip_setmoptions Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec10)
                1. [Construct the defaults](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec13)
                1. [Process options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec14)
                1. [Discard structure if defaults are OK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec15)
                1. [Selecting an Explicit Multicast Interface: IP_MULTICAST_IF](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec16)
                1. [Validation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec17)
                1. [Select the default interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec18)
                1. [Selecting an Explicit Multicast TTL: IP_MULTICAST_TTL](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec19)
                1. [Validate and select the default TTL](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec20)
                1. [Selecting Multicast Loopbacks: IP_MULTICAST_LOOP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec21)
                1. [Validate and select the loopback policy](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec22)
            1. [12.11. Joining an IP Multicast Group](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec11)
                1. [Validation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec23)
                1. [Locate the interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec24)
                1. [Already a member?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec25)
                1. [Join the group](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec26)
                1. [in_addmulti Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec27)
                1. [Already a member](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec28)
                1. [Update the in_multi list](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec29)
                1. [Update the interface and announce the change](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec30)
                1. [slioctl and loioctl Functions: SIOCADDMULTI and SIOCDELMULTI](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec31)
                1. [leioctl Function: SIOCADDMULTI and SIOCDELMULTI](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec32)
                1. [ether_addmulti Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec33)
                1. [Initialize address range](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec34)
                1. [Already receiving](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec35)
                1. [Update ether_multi list](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec36)
            1. [12.12. Leaving an IP Multicast Group](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec12)
                1. [Validation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec37)
                1. [Delete membership references](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec38)
                1. [in_delmulti Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec39)
                1. [Update in_multi structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec40)
                1. [ether_delmulti Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec41)
                1. [Locate ether_multi structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec42)
                1. [Delete ether_multi structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec43)
            1. [12.13. ip_getmoptions Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec13)
                1. [Copy the option data and return](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec44)
            1. [12.14. Multicast Input Processing: ipintr Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec14)
                1. [Forward packets if configured as multicast router](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec45)
            1. [12.15. Multicast Output Processing: ip_output Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec15)
                1. [Establish defaults](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec46)
                1. [Select source address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec47)
                1. [Loopback or not?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec48)
                1. [Forward or not?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec49)
                1. [Transmit or not?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec50)
                1. [Send packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec51)
                1. [ip_mloopback Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec52)
                1. [Duplicate and queue packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev2sec53)
            1. [12.16. Performance Considerations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec16)
        1. [12.17. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec17)
            1. [12.17. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec17)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_18.html#ch12lev1sec18)
    1. [13. IGMP: Internet Group Management Protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html)
        1. [13.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec1)
            1. [13.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec1)
            1. [13.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec3)
            1. [13.3. igmp Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec3)
            1. [13.4. IGMP protosw Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec4)
            1. [13.5. Joining a Group: igmp_joingroup Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec5)
            1. [13.6. igmp_fasttimo Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec6)
                1. [igmp_sendreport Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec4)
            1. [13.7. Input Processing: igmp_input Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec7)
                1. [Validate IGMP message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec5)
                1. [Pass IGMP messages to raw IP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec6)
                1. [Membership Query: IGMP_HOST_MEMBERSHIP_QUERY](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec7)
                1. [Membership Report: IGMP_HOST_MEMBERSHIP_REPORT](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev2sec8)
            1. [13.8. Leaving a Group: igmp_leavegroup Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec8)
        1. [13.9. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec9)
            1. [13.9. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec9)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_19.html#ch13lev1sec10)
    1. [14. IP Multicast Routing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html)
        1. [14.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec1)
            1. [14.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec1)
            1. [14.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec3)
            1. [14.3. Multicast Output Processing Revisited](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec3)
            1. [14.4. mrouted Daemon](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec4)
            1. [14.5. Virtual Interfaces](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec5)
                1. [Virtual Interface Table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec4)
                1. [add_vif Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec5)
                1. [Validate index](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec6)
                1. [Locate physical interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec7)
                1. [Configure tunnel interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec8)
                1. [Configure physical interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec9)
                1. [Save multicast information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec10)
                1. [del_vif Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec11)
                1. [Validate index](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec12)
                1. [Delete interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec13)
                1. [Adjust interface count](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec14)
            1. [14.6. IGMP Revisited](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec6)
                1. [add_lgrp Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec15)
                1. [Validate add request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec16)
                1. [If needed, expand group array](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec17)
                1. [Add new group](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec18)
                1. [del_lgrp Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec19)
                1. [Validate interface index](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec20)
                1. [Update lookup cache](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec21)
                1. [Delete group](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec22)
                1. [grplst_member Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec23)
                1. [Check the cache](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec24)
                1. [Search the membership array](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec25)
            1. [14.7. Multicast Routing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec7)
                1. [Multicast Routing Table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec26)
                1. [del_mrt Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec27)
                1. [Find route entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec28)
                1. [Delete route entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec29)
                1. [add_mrt Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec30)
                1. [Update existing route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec31)
                1. [Allocate new route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec32)
                1. [mrtfind Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec33)
                1. [Check route lookup cache](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec34)
                1. [Check the hash table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec35)
            1. [14.8. Multicast Forwarding: ip_mforward Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec8)
                1. [Arrival on physical interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec36)
                1. [Arrival on a tunnel](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec37)
                1. [Delete tunnel options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec38)
                1. [Expired TTL or local multicast](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec39)
                1. [No route available](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec40)
                1. [Arrived on unexpected interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec41)
                1. [phyint_send Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec42)
                1. [tunnel_send Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec43)
                1. [Will the tunnel options fit?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec44)
                1. [Duplicate the datagram and allocate mbuf for new header and tunnel options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec45)
                1. [Modify IP header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec46)
                1. [Construct tunnel options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec47)
                1. [Send the tunneled datagram](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev2sec48)
            1. [14.9. Cleanup: ip_mrouter_done Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec9)
        1. [14.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec10)
            1. [14.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec10)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_20.html#ch14lev1sec11)
    1. [15. Socket Layer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html)
        1. [15.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec1)
            1. [15.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec1)
                1. [splnet Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec1)
            1. [15.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec2)
            1. [15.3. socket Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec3)
                1. [SS_NBIO and SS_ASYNC Flags](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec3)
            1. [15.4. System Calls](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec4)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec4)
                1. [System Call Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec5)
            1. [15.5. Processes, Descriptors, and Sockets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec5)
            1. [15.6. socket System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec6)
                1. [socreate Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec6)
                1. [Find protocol switch table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec7)
                1. [Allocate and initialize socket structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec8)
                1. [PRU_ATTACH request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec9)
                1. [Cleanup and return](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec10)
                1. [Superuser Privileges](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec11)
            1. [15.7. getsock and sockargs Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec7)
            1. [15.8. bind System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec8)
                1. [sobind Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec12)
            1. [15.9. listen System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec9)
                1. [solisten Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec13)
            1. [15.10. tsleep and wakeup Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec10)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec14)
            1. [15.11. accept System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec11)
                1. [Validate arguments](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec15)
                1. [Wait for a connection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec16)
                1. [Asynchronous errors](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec17)
                1. [Associate socket with descriptor](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec18)
                1. [Protocol processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec19)
                1. [soaccept Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec20)
            1. [15.12. sonewconn and soisconnected Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec12)
                1. [Limit incoming connections](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec21)
                1. [Allocate new socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec22)
                1. [Queue connection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec23)
                1. [Protocol processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec24)
                1. [Wakeup processes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec25)
                1. [Queue incomplete connections](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec26)
                1. [Wakeup processes waiting for new connection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec27)
            1. [15.13. connect System call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec13)
                1. [Start connection processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec28)
                1. [Wait for connection establishment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec29)
                1. [soconnect Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec30)
                1. [Breaking a Connectionless Association](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec31)
            1. [15.14. shutdown System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec14)
                1. [soshutdown and sorflush](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec32)
                1. [Release control mbufs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec33)
            1. [15.15. close System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec15)
                1. [soo_close Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec34)
                1. [soclose Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec35)
                1. [Discard pending connections](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec36)
                1. [Break established connection or association](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec37)
                1. [Release data structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec38)
                1. [Return if socket still in use](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec39)
                1. [Remove from connection queues](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec40)
                1. [Discard send and receive queues](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev2sec41)
        1. [15.16. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec16)
            1. [15.16. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec16)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_21.html#ch15lev1sec17)
    1. [16. Socket I/O](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html)
        1. [16.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec1)
            1. [16.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec1)
            1. [16.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec1)
            1. [16.3. Socket Buffers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec3)
                1. [Socket Macros and Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec2)
            1. [16.4. write, writev, sendto, and sendmsg System Calls](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec4)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec3)
            1. [16.5. sendmsg System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec5)
                1. [Copy iov array](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec4)
                1. [sendit and cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec5)
            1. [16.6. sendit Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec6)
                1. [uiomove Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec6)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec7)
                1. [sendit Code](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec8)
                1. [Initialize auio](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec9)
                1. [Copy address and control information from the process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec10)
                1. [Send data and cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec11)
            1. [16.7. sosend Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec7)
                1. [Reliable Protocol Buffering](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec12)
                1. [Unreliable Protocol Buffering](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec13)
                1. [sosend Code](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec14)
                1. [Lock send buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec15)
                1. [Check for space](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec16)
                1. [Use data from top](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec17)
                1. [Copy data from process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec18)
                1. [Pass data to the protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec19)
                1. [Cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec20)
                1. [Compute transfer size and semantics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec21)
                1. [If requested, disable routing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec22)
                1. [Compute available space](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec23)
                1. [Enforce message size limit](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec24)
                1. [Wait for more space?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec25)
                1. [Wait for space](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec26)
                1. [Allocate packet header or standard mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec27)
                1. [If possible, use a cluster](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec28)
                1. [Prepare the mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec29)
                1. [Get data from the process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec30)
                1. [Fill another buffer?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec31)
                1. [sosend Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec32)
                1. [Performance Considerations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec33)
            1. [16.8. read, readv, recvfrom, and recvmsg System Calls](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec8)
            1. [16.9. recvmsg System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec9)
                1. [Copy iov array](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec34)
                1. [recvit and cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec35)
            1. [16.10. recvit Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec10)
                1. [Call soreceive](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec36)
                1. [Copy address and control information to the process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec37)
                1. [Cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec38)
            1. [16.11. soreceive Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec11)
                1. [Out-of-Band Data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec39)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec40)
                1. [Other Receive Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec41)
                1. [Receive Buffer Organization: Message Boundaries](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec42)
                1. [Receive Buffer Organization: No Message Boundaries](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec43)
                1. [Control Information and Out-of-band Data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec44)
            1. [16.12. soreceive Code](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec12)
                1. [If necessary, wait for data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec45)
                1. [Process address and control information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec46)
                1. [Setup data transfer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec47)
                1. [Mbuf data transfer loop](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec48)
                1. [Cleanup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec49)
                1. [Receive OOB data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec50)
                1. [Connection confirmation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec51)
                1. [Can the call be satisfied now?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec52)
                1. [Wait for more data?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec53)
                1. [Yes, wait for more data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec54)
                1. [dontblock](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec55)
                1. [Return address information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec56)
                1. [Return control information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec57)
                1. [Prepare to transfer data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec58)
                1. [Check for transition between OOB and regular data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec59)
                1. [Update OOB mark](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec60)
                1. [Finished with mbuf?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec61)
                1. [More data to process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec62)
                1. [Update OOB mark](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec63)
                1. [End of logical record](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec64)
                1. [MSG_WAITALL](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec65)
                1. [Error or no more data will arrive](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec66)
                1. [Wait for data to arrive](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec67)
                1. [Synchronize m and nextrecord with receive buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec68)
                1. [Process next mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec69)
                1. [Truncated message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec70)
                1. [End of record processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec71)
                1. [Nothing transferred](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec72)
                1. [Analysis](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec73)
            1. [16.13. select System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec13)
                1. [Validation and setup](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec74)
                1. [Copy file descriptor sets from process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec75)
                1. [Setup timeout value](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec76)
                1. [Scan file descriptors](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec77)
                1. [Error or some descriptors are ready](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec78)
                1. [Timeout expired?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec79)
                1. [Status changed during selscan](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec80)
                1. [Wait for buffer changes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec81)
                1. [Ready to return](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec82)
                1. [selscan Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec83)
                1. [Locate descriptors to be monitored](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec84)
                1. [Poll descriptor](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec85)
                1. [Descriptor is ready](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec86)
                1. [soo_select Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec87)
                1. [Is socket readable?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec88)
                1. [Is socket writeable?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec89)
                1. [Are there any exceptional conditions pending?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec90)
                1. [selrecord Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec91)
                1. [Already selecting on this descriptor](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec92)
                1. [Select collision with another process?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec93)
                1. [No collision](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec94)
                1. [selwakeup Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec95)
                1. [Wake all processes during a collision](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev2sec96)
        1. [16.14. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec14)
            1. [16.14. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec14)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_22.html#ch16lev1sec15)
    1. [17. Socket Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html)
        1. [17.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec1)
            1. [17.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec1)
            1. [17.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec2)
                1. [Global Variables and Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev2sec1)
            1. [17.3. setsockopt System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec3)
                1. [sosetopt Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev2sec2)
            1. [17.4. getsockopt System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec4)
                1. [sogetopt Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev2sec3)
            1. [17.5. fcntl and ioctl System Calls](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec5)
                1. [fcntl Code](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev2sec4)
                1. [ioctl Code](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev2sec5)
            1. [17.6. getsockname System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec6)
            1. [17.7. getpeername System Call](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec7)
        1. [17.8. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec8)
            1. [17.8. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec8)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_23.html#ch17lev1sec9)
    1. [18. Radix Tree Routing Tables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html)
        1. [18.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec1)
            1. [18.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec1)
            1. [18.2. Routing Table Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec2)
                1. [Exampleâ€”Host Match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec1)
                1. [Exampleâ€”Host Match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec2)
                1. [Exampleâ€”Network Match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec3)
                1. [Exampleâ€”Default Match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec4)
                1. [Exampleâ€”Network Match with Backtracking](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec5)
                1. [Exampleâ€”Backtracking Multiple Levels](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec6)
                1. [Exampleâ€”Host Match with Backtracking and Cloning](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec7)
                1. [The Big Picture](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec8)
            1. [18.3. Routing Sockets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec3)
            1. [18.4. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec4)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec9)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec10)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec11)
            1. [18.5. Radix Node Data Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec5)
            1. [18.6. Routing Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec6)
            1. [18.7. Initialization: route_init and rtable_init Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec7)
            1. [18.8. Initialization: rn_init and rn_inithead Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec8)
                1. [Determine max_keylen](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec12)
                1. [Allocate and initialize rn_zeros, rn_ones, and maskedKey](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec13)
                1. [Initialize tree of masks](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec14)
            1. [18.9. Duplicate Keys and Mask Lists](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec9)
            1. [18.10. rn_match Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec10)
                1. [Go down the tree to the corresponding leaf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec15)
                1. [Check for exact match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec16)
                1. [Explicit check for default](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev2sec17)
            1. [18.11. rn_search Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec11)
        1. [18.12. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec12)
            1. [18.12. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec12)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_24.html#ch18lev1sec13)
    1. [19. Routing Requests and Routing Messages](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html)
        1. [19.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec1)
            1. [19.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec1)
            1. [19.2. rtalloc and rtalloc1 Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec2)
                1. [Call rn_match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec1)
                1. [Search fails](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec2)
                1. [Create clone entries](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec3)
                1. [Clone creation fails](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec4)
                1. [Check for external resolution](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec5)
                1. [Increment reference count for normal successful search](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec6)
            1. [19.3. RTFREE Macro and rtfree Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec3)
                1. [Release interface reference](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec7)
                1. [Release routing memory](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec8)
                1. [Routing Table Reference Counts](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec9)
            1. [19.4. rtrequest Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec4)
                1. [Delete from routing tree](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec10)
                1. [Remove reference to gateway routing table entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec11)
                1. [Call interface request function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec12)
                1. [Return pointer or release reference](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec13)
                1. [Locate corresponding interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec14)
                1. [Allocate memory for routing table entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec15)
                1. [Allocate and copy gateway address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec16)
                1. [Copy destination address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec17)
                1. [Add entry to routing tree](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec18)
                1. [Store interface pointers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec19)
                1. [Copy metrics for newly cloned route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec20)
                1. [Call interface request function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec21)
                1. [Return pointer and increment reference count](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec22)
                1. [Example: Cloned Routes with Network Masks](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec23)
            1. [19.5. rt_setgate Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec5)
                1. [Set lengths from socket address structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec24)
                1. [Allocate memory](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec25)
                1. [Use memory already allocated for key and gateway](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec26)
                1. [Copy new gateway](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec27)
                1. [Copy key from old memory to new memory](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec28)
                1. [Release gateway routing pointer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec29)
                1. [Locate and store new gateway routing pointer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec30)
            1. [19.6. rtinit Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec6)
                1. [Get destination address for route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec31)
                1. [Mask network address with network mask](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec32)
                1. [Search for routing table entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec33)
                1. [Process request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec34)
                1. [Generate routing message on successful delete](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec35)
                1. [Successful add](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec36)
                1. [Incorrect interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec37)
                1. [Generate routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec38)
            1. [19.7. rtredirect Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec7)
                1. [New gateway must be directly connected](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec39)
                1. [Locate routing table entry for destination and validate redirect](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec40)
                1. [Must create a new route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec41)
                1. [Create new host route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec42)
                1. [Create route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec43)
                1. [Modify existing host route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec44)
                1. [Ignore if destination is directly connected](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec45)
                1. [Return pointer and increment statistic](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec46)
                1. [Generate routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec47)
            1. [19.8. Routing Message Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec8)
            1. [19.9. rt_missmsg Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec9)
                1. [Build message in mbuf chain](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec48)
                1. [Finish building message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec49)
                1. [Set protocol of message, call raw_input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec50)
            1. [19.10. rt_ifmsg Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec10)
                1. [Build message in mbuf chain](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec51)
                1. [Finish building message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec52)
                1. [Set protocol of message, call raw_input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec53)
            1. [19.11. rt_newaddrmsg Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec11)
                1. [Generate two routing messages](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec54)
                1. [Generate message with up to four addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec55)
                1. [Finish building message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec56)
                1. [Build message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec57)
                1. [Set protocol of message, call raw_input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec58)
            1. [19.12. rt_msg1 Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec12)
                1. [Get mbuf and determine fixed size of message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec59)
                1. [Verify structure fits in mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec60)
                1. [Initialize mbuf packet header and zero structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec61)
                1. [Copy socket address structures into mbuf chain](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec62)
                1. [Store length, version, and type](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec63)
            1. [19.13. rt_msg2 Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec13)
                1. [Determine size of structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec64)
                1. [Copy socket address structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec65)
                1. [Check if data to be stored](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec66)
                1. [Allocate buffer first time or if message length increases](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec67)
                1. [Go around again and store result](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec68)
                1. [Store length, version, and type](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec69)
            1. [19.14. sysctl_rtable Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec14)
                1. [Validate arguments](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec70)
                1. [Initialize walkarg structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec71)
                1. [Dump routing table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec72)
                1. [Return interface list](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec73)
                1. [Release buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec74)
                1. [Update w_needed](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec75)
                1. [Return actual size of message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec76)
                1. [Return estimated size of message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec77)
            1. [19.15. sysctl_dumpentry Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec15)
                1. [Check flags of routing table entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec78)
                1. [Form routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec79)
                1. [Copy message back to process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec80)
            1. [19.16. sysctl_iflist Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec16)
                1. [Check interface index](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec81)
                1. [Build routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec82)
                1. [Copy message back to process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec83)
                1. [Iterate through address structures, check address family](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec84)
                1. [Build routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec85)
                1. [Copy message back to process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev2sec86)
        1. [19.17. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec17)
            1. [19.17. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec17)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_25.html#ch19lev1sec18)
    1. [20. Routing Sockets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html)
        1. [20.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec1)
            1. [20.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec1)
            1. [20.2. routedomain and protosw Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec2)
            1. [20.3. Routing Control Blocks](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec3)
            1. [20.4. raw_init Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec4)
            1. [20.5. route_output Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec5)
                1. [Check mbuf for validity](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec1)
                1. [Allocate buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec2)
                1. [Check version number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec3)
                1. [Destination address required](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec4)
                1. [Handle optional genmask](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec5)
                1. [Locate existing entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec6)
                1. [Do not allow network match](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec7)
                1. [Use network mask to find correct entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec8)
                1. [Return destination, gateway, and masks](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec9)
                1. [Return interface information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec10)
                1. [Construct reply](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec11)
                1. [Change gateway](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec12)
                1. [Locate new interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec13)
                1. [Check if interface changed](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec14)
                1. [Update metrics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec15)
                1. [Call interface request function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec16)
                1. [Store clone generation mask](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec17)
                1. [Update bitmask of locked metrics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec18)
                1. [Return error or OK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec19)
                1. [Release held route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec20)
                1. [No process to receive message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec21)
                1. [Other listeners but no loopback copy](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec22)
                1. [Convert buffer into mbuf chain](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec23)
                1. [Avoid loopback copy](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec24)
                1. [Set address family of routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec25)
            1. [20.6. rt_xaddrs Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec6)
            1. [20.7. rt_setmetrics Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec7)
            1. [20.8. raw_input Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec8)
                1. [Compare address family and protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec26)
                1. [Compare local and foreign addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec27)
                1. [Append message to socket receive buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec28)
            1. [20.9. route_usrreq Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec9)
                1. [PRU_ATTACH: allocate control block](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec29)
                1. [PRU_DETACH: decrement counters](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec30)
                1. [Process request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec31)
                1. [Increment counters](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec32)
                1. [Connect socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec33)
                1. [Enable SO_USELOOPBACK by default](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec34)
            1. [20.10. raw_usrreq Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec10)
                1. [PRU_CONTROL requests invalid](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec35)
                1. [Control information invalid](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec36)
                1. [Socket must have a control block](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev2sec37)
            1. [20.11. raw_attach, raw_detach, and raw_disconnect Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec11)
        1. [20.12. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec12)
            1. [20.12. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec12)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_26.html#ch20lev1sec13)
    1. [21. ARP: Address Resolution Protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html)
        1. [21.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec1)
            1. [21.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec1)
            1. [21.2. ARP and the Routing Table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec2)
            1. [21.3. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec3)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec3)
            1. [21.4. ARP Structures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec4)
            1. [21.5. arpwhohas Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec5)
            1. [21.6. arprequest Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec6)
                1. [Allocate and initialize mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec4)
                1. [Initialize pointers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec5)
                1. [Fill in Ethernet header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec6)
                1. [Fill in ARP fields](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec7)
                1. [Fill in sockaddr and call interface output function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec8)
            1. [21.7. arpintr Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec7)
            1. [21.8. in_arpinput Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec8)
                1. [Look for matching interface and IP address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec9)
                1. [Validate senderâ€™s hardware address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec10)
                1. [Check senderâ€™s IP address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec11)
                1. [Search routing table for match with senderâ€™s IP address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec12)
                1. [Update existing entry or fill in new entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec13)
                1. [Check if senderâ€™s hardware addresses changed](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec14)
                1. [Record senderâ€™s hardware address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec15)
                1. [Update newly resolved ARP entry](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec16)
                1. [Finished with ARP reply packets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec17)
                1. [This host is the target](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec18)
                1. [Check if this host is a proxy server for target](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec19)
                1. [Form proxy reply](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec20)
                1. [Complete construction of ARP reply packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec21)
                1. [Fill in sockaddr with Ethernet header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec22)
            1. [21.9. ARP Timer Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec9)
                1. [arptimer Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec23)
                1. [Set next timeout](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec24)
                1. [Check all ARP entries](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec25)
                1. [arptfree Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec26)
                1. [Invalidate (donâ€™t delete) entries in use](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec27)
                1. [Delete unreferenced entries](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec28)
            1. [21.10. arpresolve Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec10)
                1. [Handle broadcast and multicast destinations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec29)
                1. [Get pointer to llinfo_arp structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec30)
                1. [Check ARP entry for validity](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec31)
                1. [Hold only most recent IP datagram](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec32)
                1. [Send ARP request but avoid ARP flooding](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec33)
            1. [21.11. arplookup Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec11)
                1. [Initialize sockaddr_inarp to look up](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec34)
                1. [Look up entry in routing table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec35)
                1. [Decrement routing table reference count](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec36)
            1. [21.12. Proxy ARP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec12)
            1. [21.13. arp_rtrequest Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec13)
                1. [Initialize ARP timeout function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec37)
                1. [Ignore indirect routes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec38)
                1. [RTM_ADD command](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec39)
                1. [Backward compatibility](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec40)
                1. [Initialize entry for network route to interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec41)
                1. [Send gratuitous ARP request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec42)
                1. [Verify sockaddr_dl Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec43)
                1. [Handle route changes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec44)
                1. [Initialize llinfo_arp structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec45)
                1. [Handle local host specially](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec46)
                1. [Make entry permanent and set Ethernet address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec47)
                1. [Set interface pointer to loopback interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec48)
                1. [Verify la pointer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec49)
                1. [Delete llinfo_arp structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev2sec50)
            1. [21.14. ARP and Multicasting](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec14)
        1. [21.15. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec15)
            1. [21.15. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec15)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_27.html#ch21lev1sec16)
    1. [22. Protocol Control Blocks](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html)
        1. [22.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec1)
            1. [22.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec1)
            1. [22.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec2)
            1. [22.3. inpcb Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec3)
            1. [22.4. in_pcballoc and in_pcbdetach Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec4)
                1. [Allocate PCB and initialize to zero](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec3)
                1. [Link structures together](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec4)
            1. [22.5. Binding, Connecting, and Demultiplexing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec5)
                1. [Binding of Local IP Address and Port Number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec5)
                1. [Connecting a UDP Socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec6)
                1. [Demultiplexing of Received IP Datagrams by TCP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec7)
                1. [Demultiplexing of Received IP Datagrams by UDP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec8)
            1. [22.6. in_pcblookup Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec6)
                1. [Compare local port number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec9)
                1. [Compare local address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec10)
                1. [Compare foreign address and foreign port number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec11)
                1. [Check if wildcard match allowed](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec12)
                1. [Remember best match, return if exact match found](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec13)
                1. [Exampleâ€”Demultiplexing of Received TCP Segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec14)
            1. [22.7. in_pcbbind Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec7)
                1. [so_reuseaddr Examples](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec15)
                1. [SO_REUSEPORT Socket Option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec16)
            1. [22.8. in_pcbconnect Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec8)
                1. [Validate argument](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec17)
                1. [Handle connection to 0.0.0.0 and 255.255.255.255 specially](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec18)
                1. [Release route if no longer valid](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec19)
                1. [Acquire route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec20)
                1. [Determine outgoing interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec21)
                1. [Verify that socket pair is unique](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec22)
                1. [Implicit bind and assignment of ephemeral port](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec23)
                1. [Store foreign address and foreign port in PCB](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec24)
                1. [IP Source Address Versus Outgoing Interface Address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec25)
            1. [22.9. in_pcbdisconnect Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec9)
            1. [22.10. in_setsockaddr and in_setpeeraddr Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec10)
            1. [22.11. in_pcbnotify, in_rtchange, and in_losing Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec11)
                1. [Verify arguments](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec26)
                1. [Handle redirects specially](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec27)
                1. [Call notify function for selected PCBs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec28)
                1. [in_rtchange Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec29)
                1. [Redirects and Raw Sockets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec30)
                1. [ICMP Errors and UDP Sockets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec31)
                1. [in_losing Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec32)
                1. [Generate routing message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec33)
                1. [Delete or release route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev2sec34)
            1. [22.12. Implementation Refinements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec12)
        1. [22.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec13)
            1. [22.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec13)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_28.html#ch22lev1sec14)
    1. [23. UDP: User Datagram Protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html)
        1. [23.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec1)
            1. [23.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec1)
            1. [23.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec3)
            1. [23.3. UDP protosw Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec3)
            1. [23.4. UDP Header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec4)
            1. [23.5. udp_init Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec5)
            1. [23.6. udp_output Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec6)
                1. [Discard optional control information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec4)
                1. [Temporarily connect an unconnected socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec5)
                1. [Prepend IP and UDP headers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec6)
                1. [Prepending IP/UDP Headers and Mbuf Clusters](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec7)
                1. [UDP Checksum Calculation and Pseudo-Header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec8)
                1. [Prepare pseudo-header for checksum computation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec9)
                1. [Calculate checksum](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec10)
                1. [Fill in UDP length, TTL, and TOS](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec11)
                1. [Send datagram](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec12)
                1. [Disconnect temporarily connected socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec13)
            1. [23.7. udp_input Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec7)
                1. [General Validation of Received UDP Datagram](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec14)
                1. [Discard IP options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec15)
                1. [Verify UDP length](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec16)
                1. [Save copy of IP header and verify UDP checksum](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec17)
                1. [Demultiplexing Unicast Datagrams](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec18)
                1. [Check one-behind cache](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec19)
                1. [Search all UDP PCBs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec20)
                1. [Generate ICMP port unreachable error](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec21)
                1. [Return source IP address and source port](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec22)
                1. [IP_RECVDSTADDR socket option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec23)
                1. [Unimplemented socket options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec24)
                1. [Append data to socketâ€™s receive queue](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec25)
                1. [Error return](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec26)
                1. [Demultiplexing Multicast and Broadcast Datagrams](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec27)
                1. [Connected UDP Sockets and Multihomed Hosts](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec28)
            1. [23.8. udp_saveopt Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec8)
            1. [23.9. udp_ctlinput Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec9)
                1. [udp_notify Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec29)
            1. [23.10. udp_usrreq Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec10)
            1. [23.11. udp_sysctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec11)
            1. [23.12. Implementation Refinements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec12)
                1. [UDP PCB Cache](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec30)
                1. [UDP Checksum](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev2sec31)
        1. [23.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec13)
            1. [23.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec13)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_29.html#ch23lev1sec14)
    1. [24. TCP: Transmission Control Protocol](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html)
        1. [24.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec1)
            1. [24.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec1)
            1. [24.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec2)
                1. [SNMP Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec3)
            1. [24.3. TCP protosw Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec3)
            1. [24.4. TCP Header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec4)
            1. [24.5. TCP Control Block](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec5)
            1. [24.6. TCP State Transition Diagram](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec6)
                1. [Half-Close](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec4)
            1. [24.7. TCP Sequence Numbers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec7)
                1. [Modular Arithmetic with Sequence Numbers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec5)
                1. [Exampleâ€”Sequence Number Comparisons](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec6)
            1. [24.8. tcp_init Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec8)
                1. [Set initial send sequence number (ISS)](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec7)
                1. [Initialize linked list of TCP Internet PCBs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec8)
                1. [Calculate maximum protocol header length](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec9)
                1. [MSL and Quiet Time Concept](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev2sec10)
        1. [24.9. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec9)
            1. [24.9. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec9)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_30.html#ch24lev1sec10)
    1. [25. TCP Timers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html)
        1. [25.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec1)
            1. [25.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec1)
            1. [25.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec2)
            1. [25.3. tcp_canceltimers Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec3)
            1. [25.4. tcp_fasttimo Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec4)
            1. [25.5. tcp_slowtimo Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec5)
                1. [Check each timer counter in all TCP control blocks](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec1)
                1. [Check if TCP control block has been deleted](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec2)
                1. [Count idle time](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec3)
                1. [Increment RTT counter](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec4)
                1. [Increment initial send sequence number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec5)
                1. [Increment RFC 1323 timestamp value](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec6)
            1. [25.6. tcp_timers Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec6)
                1. [FIN_WAIT_2 and 2MSL Timers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec7)
                1. [2MSL timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec8)
                1. [FIN_WAIT_2 timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec9)
                1. [Persist Timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec10)
                1. [Force window probe segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec11)
                1. [Connection Establishment and Keepalive Timers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec12)
                1. [Connection-establishment timer expires after 75 seconds](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec13)
                1. [Keepalive timer expires after 2 hours of idle time](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec14)
                1. [Drop connection when no response](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec15)
                1. [Send a keepalive probe](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec16)
                1. [Reset keepalive timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec17)
            1. [25.7. Retransmission Timer Calculations](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec7)
            1. [25.8. tcp_newtcpcb Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec8)
            1. [25.9. tcp_setpersist Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec9)
                1. [Check retransmission timer not enabled](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec18)
                1. [Calculate RTO](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec19)
                1. [Apply exponential backoff](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec20)
            1. [25.10. tcp_xmit_timer Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec10)
                1. [Update smoothed estimators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec21)
                1. [Initialize smoothed estimators on first RTT measurement](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec22)
                1. [Clear soft error variable](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec23)
            1. [25.11. Retransmission Timeout: tcp_timers Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec11)
                1. [Increment shift count](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec24)
                1. [Drop connection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec25)
                1. [Calculate new RTO](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec26)
                1. [Ask IP to find a new route](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec27)
                1. [Clear estimators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec28)
                1. [Force retransmission of oldest unacknowledged data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec29)
                1. [Karnâ€™s algorithm](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec30)
                1. [Slow Start and Congestion Avoidance](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec31)
                1. [Accuracy](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev2sec32)
            1. [25.12. An RTT Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec12)
        1. [25.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec13)
            1. [25.13. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec13)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_31.html#ch25lev1sec14)
    1. [26. TCP Output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html)
        1. [26.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec1)
            1. [26.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec1)
            1. [26.2. tcp_output Overview](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec2)
                1. [Is an ACK expected from the other end?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec1)
                1. [Go back to slow start](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec2)
                1. [Send more than one segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec3)
            1. [26.3. Determine if a Segment Should be Sent](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec3)
                1. [Calculate amount of data to send](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec4)
                1. [Check for window shrink](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec5)
                1. [Enter persist state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec6)
                1. [Send one segment at a time](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec7)
                1. [Turn off FIN flag if send buffer not emptied](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec8)
                1. [Calculate window advertisement](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec9)
                1. [Sender silly window avoidance](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec10)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec11)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec12)
            1. [26.4. TCP Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec4)
            1. [26.5. Window Scale Option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec5)
            1. [26.6. Timestamp Option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec6)
                1. [Which Timestamp to Echo, RFC 1323 Algorithm](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec13)
                1. [Which Timestamp to Echo, Corrected Algorithm](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec14)
                1. [Timestamps and Delayed ACKs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec15)
            1. [26.7. Send a Segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec7)
                1. [Build MSS option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec16)
                1. [Should window scale option be sent?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec17)
                1. [Build window scale option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec18)
                1. [Should timestamp option be sent?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec19)
                1. [Build timestamp option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec20)
                1. [Check if options have overflowed segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec21)
                1. [Update statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec22)
                1. [Allocate an mbuf for IP and TCP headers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec23)
                1. [Copy data into mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec24)
                1. [Set PSH flag](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec25)
                1. [Update statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec26)
                1. [Get mbuf for IP and TCP headers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec27)
                1. [Copy IP and TCP header templates into mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec28)
                1. [Decrement snd_nxt if FIN is being retransmitted](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec29)
                1. [Set sequence number field of segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec30)
                1. [Set acknowledgment field of segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec31)
                1. [Set header length if options present](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec32)
                1. [Donâ€™t advertise less than one full-sized segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec33)
                1. [Observe upper limit for advertised window on this connection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec34)
                1. [Do not shrink window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec35)
                1. [Set urgent offset](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec36)
                1. [Remember starting sequence number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec37)
                1. [Increment snd_nxt](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec38)
                1. [Update snd_max](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec39)
                1. [Set retransmission timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec40)
                1. [Persist state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec41)
                1. [Add trace record for socket debugging](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec42)
                1. [Set IP length, TTL, and TOS](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec43)
                1. [Pass datagram to IP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec44)
                1. [Update rcv_adv and last_ack_sent](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec45)
                1. [More data to send?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec46)
            1. [26.8. tcp_template Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec8)
                1. [Allocate mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec47)
                1. [Initialize header fields](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec48)
                1. [Pseudo-header for TCP checksum computation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec49)
            1. [26.9. tcp_respond Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec9)
                1. [Send keepalive probe when keepalive timer expires](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec50)
                1. [Send RST segment in response to received segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev2sec51)
        1. [26.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec10)
            1. [26.10. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec10)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_32.html#ch26lev1sec11)
    1. [27. TCP Functions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html)
        1. [27.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec1)
            1. [27.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec1)
            1. [27.2. tcp_drain Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec2)
            1. [27.3. tcp_drop Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec3)
            1. [27.4. tcp_close Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec4)
                1. [Route Characteristics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec1)
                1. [Check if enough data sent to update statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec2)
                1. [Update RTT](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec3)
                1. [Update mean deviation](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec4)
                1. [Resource Release](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec5)
                1. [Release any mbufs on reassembly queue](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec6)
                1. [Release header template and TCP control block](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec7)
                1. [Release PCB](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec8)
            1. [27.5. tcp_mss Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec5)
                1. [Acquire a route if necessary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec9)
                1. [Initialize smoothed RTT estimator](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec10)
                1. [Initialize smoothed mean deviation estimator](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec11)
                1. [Calculate initial RTO](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec12)
                1. [Use MSS from routing table MTU](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec13)
                1. [Round MSS down to multiple of MCLBYTES](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec14)
                1. [Check if destination local or nonlocal](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec15)
                1. [Other endâ€™s MSS is upper bound](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec16)
                1. [Round buffer sizes to multiple of MSS](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec17)
                1. [Initialize congestion window and slow start threshold](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec18)
                1. [Example](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec19)
            1. [27.6. tcp_ctlinput Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec6)
            1. [27.7. tcp_notify Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec7)
            1. [27.8. tcp_quench Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec8)
            1. [27.9. TCP_REASS Macro and tcp_reass Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec9)
                1. [TCP_REASS Macro](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec20)
                1. [tcp_reass Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec21)
            1. [27.10. tcp_trace Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec10)
                1. [Sample Output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev2sec22)
        1. [27.11. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec11)
            1. [27.11. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec11)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_33.html#ch27lev1sec12)
    1. [28. TCP Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html)
        1. [28.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec1)
            1. [28.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec1)
            1. [28.2. Preliminary Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec2)
                1. [Get IP and TCP headers in first mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec1)
                1. [Verify TCP checksum](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec2)
                1. [Verify TCP offset field](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec3)
                1. [Get headers plus option into first mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec4)
                1. [Process timestamp option quickly](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec5)
                1. [Save input flags and convert fields to host byte order](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec6)
                1. [Locate Internet PCB](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec7)
                1. [Drop segment and generate RST](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec8)
                1. [Silently drop segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec9)
                1. [Unscale advertised window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec10)
                1. [Save connection state and IP/TCP headers if socket debug option enabled](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec11)
                1. [Create new socket if segment arrives for listening socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec12)
                1. [Compute window scale factor](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec13)
                1. [Reset idle time and keepalive timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec14)
                1. [Process TCP options if not in LISTEN state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec15)
            1. [28.3. tcp_dooptions Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec3)
                1. [Fetch option type and length](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec16)
                1. [MSS option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec17)
                1. [Window scale option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec18)
                1. [Timestamp option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec19)
            1. [28.4. Header Prediction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec4)
                1. [Check if segment is the next expected](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec20)
                1. [Update ts_recent from received timestamp](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec21)
                1. [Test for pure ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec22)
                1. [Update RTT estimators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec23)
                1. [Delete acknowledged bytes from send buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec24)
                1. [Stop retransmit timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec25)
                1. [Awaken waiting processes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec26)
                1. [Generate more output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec27)
                1. [Test for next in-sequence data segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec28)
                1. [Complete processing of received data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec29)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec30)
            1. [28.5. TCP Input: Slow Path Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec5)
                1. [Drop IP and TCP headers, including TCP options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec31)
                1. [Calculate receive window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec32)
            1. [28.6. Initiation of Passive Open, Completion of Active Open](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec6)
                1. [Initiation of Passive Open](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec33)
                1. [Drop if RST, ACK, or no SYN](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec34)
                1. [Drop if broadcast or multicast](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec35)
                1. [Get mbuf for clientâ€™s IP address and port](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec36)
                1. [Set local address in PCB](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec37)
                1. [Connect PCB to peer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec38)
                1. [Allocate and initialize IP and TCP header template](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec39)
                1. [Process any TCP options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec40)
                1. [Initialize ISS](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec41)
                1. [Initialize sequence number variables in control block](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec42)
                1. [ACK the SYN and change state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec43)
                1. [Completion of Active Open](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec44)
                1. [Verify received ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec45)
                1. [Process and drop RST segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec46)
                1. [Verify SYN flag set](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec47)
                1. [Process ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec48)
                1. [Turn off retransmission timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec49)
                1. [Initialize receive sequence numbers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec50)
                1. [Connection is established](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec51)
                1. [Check for window scale option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec52)
                1. [Pass any queued data to process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec53)
                1. [Update RTT estimators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec54)
                1. [Simultaneous open](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec55)
                1. [Drop any received data that follows receive window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec56)
                1. [Force update of window variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec57)
            1. [28.7. PAWS: Protection Against Wrapped Sequence Numbers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec7)
                1. [Basic PAWS test](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec58)
                1. [Check for outdated timestamp](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec59)
                1. [Drop duplicate segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec60)
            1. [28.8. Trim Segment so Data is Within Window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec8)
                1. [Check if any duplicate data at front of segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec61)
                1. [Remove duplicate SYN](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec62)
                1. [Check for entire duplicate packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec63)
                1. [Check for duplicate FIN](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec64)
                1. [Generate duplicate ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec65)
                1. [Handle simultaneous open or self-connect](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec66)
                1. [Update statistics for partial duplicate segments](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec67)
                1. [Remove duplicate data and update urgent offset](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec68)
                1. [Calculate number of bytes beyond right edge of window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec69)
                1. [Check for new incarnation of a connection in the TIME_WAIT state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec70)
                1. [Check for probe of closed window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec71)
                1. [Drop other segments that are completely outside window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec72)
                1. [Handle segments that contain some valid data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec73)
                1. [When to Drop an ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec74)
            1. [28.9. Self-Connects and Simultaneous Opens](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec9)
            1. [28.10. Record Timestamp](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec10)
            1. [28.11. RST Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec11)
                1. [SYN_RCVD state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec75)
                1. [Other states](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev2sec76)
        1. [28.12. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec12)
            1. [28.12. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec12)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_34.html#ch28lev1sec13)
    1. [29. TCP Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html)
        1. [29.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec1)
            1. [29.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec1)
            1. [29.2. ACK Processing Overview](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec2)
            1. [29.3. Completion of Passive Opens and Simultaneous Opens](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec3)
                1. [Verify received ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec1)
                1. [Check for window scale option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec2)
                1. [Pass queued data to process](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec3)
            1. [29.4. Fast Retransmit and Fast Recovery Algorithms](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec4)
                1. [Number of consecutive duplicate ACKs reaches threshold of 3](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec4)
                1. [Turn off retransmission timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec5)
                1. [Retransmit missing segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec6)
                1. [Set congestion window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec7)
                1. [Set snd_nxt](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec8)
                1. [Number of consecutive duplicate ACKs exceeds threshold of 3](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec9)
                1. [Skip remainder of ACK processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec10)
            1. [29.5. ACK Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec5)
                1. [Adjust congestion window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec11)
                1. [Check for out-of-range ACK](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec12)
                1. [Calculate number of bytes acknowledged](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec13)
                1. [Update RTT estimators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec14)
                1. [Check if all outstanding data has been acknowledged](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec15)
                1. [Unacknowledged data outstanding](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec16)
                1. [Karnâ€™s Algorithm and Timestamps](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec17)
                1. [Update congestion window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec18)
                1. [Remove acknowledged bytes from the send buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec19)
                1. [Wakeup processes waiting on send buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec20)
                1. [Receipt of ACK in FIN_WAIT_1 state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec21)
                1. [Set FIN_WAIT_2 timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec22)
                1. [Receipt of ACK in CLOSING state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec23)
                1. [Receipt of ACK in LAST_ACK state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec24)
                1. [Receipt of ACK in TIME WAIT state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec25)
            1. [29.6. Update Window Information](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec6)
                1. [Check if send window should be updated](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec26)
                1. [Update variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec27)
            1. [29.7. Urgent Mode Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec7)
                1. [Check if URG flag should be processed](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec28)
                1. [Ignore bogus urgent offsets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec29)
                1. [Calculate receive urgent pointer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec30)
                1. [Notify process of TCPâ€™s urgent mode](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec31)
                1. [Pull out-of-band byte out of normal data stream](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec32)
                1. [Adjust receive urgent pointer if not urgent mode](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec33)
            1. [29.8. tcp_pulloutofband Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec8)
                1. [Skip to next mbuf in chain](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec34)
            1. [29.9. Processing of Received Data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec9)
                1. [Guess size of other endâ€™s send buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec35)
            1. [29.10. FIN Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec10)
                1. [Process first FIN received on connection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec36)
                1. [SYN_RCVD or ESTABLISHED states](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec37)
                1. [FIN_WAIT_1 state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec38)
                1. [FIN_WAIT_2 state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec39)
                1. [Start TIME_WAIT timer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec40)
                1. [TIME_WAIT state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec41)
            1. [29.11. Final Processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec11)
                1. [SO_DEBUG socket option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec42)
                1. [Call tcp_output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec43)
                1. [dropafterack](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec44)
                1. [dropwithreset](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec45)
                1. [Sequence number and acknowledgment number of RST segment](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec46)
                1. [Rejecting connections](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec47)
                1. [Destroy temporarily created socket](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec48)
                1. [Drop (without ACK or RST)](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec49)
            1. [29.12. Implementation Refinements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec12)
            1. [29.13. Header Compression](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec13)
                1. [Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec50)
                1. [Compression of Header Fields](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec51)
                1. [Special Cases](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec52)
                1. [Examples](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec53)
                1. [Configuration](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev2sec54)
        1. [29.14. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec14)
            1. [29.14. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec14)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_35.html#ch29lev1sec15)
    1. [30. TCP User Requests](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html)
        1. [30.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec1)
            1. [30.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec1)
            1. [30.2. tcp_usrreq Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec2)
                1. [in_control processes ioctl requests](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec1)
                1. [Control information is invalid](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec2)
                1. [PRU_ATTACH request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec3)
                1. [PRU_DETACH request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec4)
                1. [Assign ephemeral port](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec5)
                1. [Connect PCB](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec6)
                1. [Initialize IP and TCP headers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec7)
                1. [Calculate window scale factor](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec8)
                1. [Set socket and connection state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec9)
                1. [Initialize sequence numbers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec10)
                1. [Send initial SYN](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec11)
                1. [PRU_SHUTDOWN request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec12)
                1. [PRU_RCVD request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec13)
                1. [PRU_SEND request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec14)
                1. [PRU_ABORT request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec15)
                1. [PRU_SENSE request](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec16)
                1. [Verify that reading out-of-band data is appropriate](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec17)
                1. [Check that out-of-band byte has arrived](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec18)
                1. [Return out-of-band byte](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec19)
                1. [Flip flags](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec20)
                1. [Check for room and append to send buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec21)
                1. [Calculate urgent pointer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec22)
                1. [Force TCP output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec23)
            1. [30.3. tcp_attach Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec3)
                1. [Allocate space for send buffer and receive buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec24)
                1. [Allocate Internet PCB and TCP control block](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec25)
            1. [30.4. tcp_disconnect Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec4)
                1. [Connection not yet synchronized](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec26)
                1. [Hard disconnect](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec27)
                1. [Graceful disconnect](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec28)
                1. [Discard pending receive data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec29)
                1. [Change connection state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec30)
            1. [30.5. tcp_usrclosed Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec5)
                1. [Simple close when SYN not received](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec31)
                1. [Move to FIN_WAIT_1 state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec32)
                1. [Move to LAST_ACK state](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec33)
            1. [30.6. tcp_ctloutput Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec6)
                1. [TCP_NODELAY option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec34)
                1. [TCP_MAXSEG option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec35)
                1. [Release mbuf](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev2sec36)
        1. [30.7. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec7)
            1. [30.7. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec7)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_36.html#ch30lev1sec8)
    1. [31. BPF: BSD Packet Filter](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html)
        1. [31.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec1)
            1. [31.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec1)
            1. [31.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec2)
            1. [31.3. bpf_if Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec3)
                1. [Initialize bpf_if structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec3)
                1. [Compute BPF header size](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec4)
                1. [Initialize bpf_dtab table](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec5)
                1. [Print console message](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec6)
            1. [31.4. bpf_d Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec4)
                1. [Packet buffers](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec7)
                1. [bpfopen Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec8)
                1. [Allocate bpf_d structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec9)
                1. [bpfioctl Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec10)
                1. [bpf_setif Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec11)
                1. [Locate matching ifnet structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec12)
                1. [Attach bpf_d structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec13)
                1. [bpf_attachd Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec14)
            1. [31.5. BPF Input](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec5)
                1. [bpf_tap Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec15)
                1. [Pass packet to one or more BPF devices](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec16)
                1. [catchpacket Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec17)
                1. [Will the packet fit?](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec18)
                1. [Immediate mode processing](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec19)
                1. [Append BPF header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec20)
                1. [bpfread Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec21)
                1. [Wait for data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec22)
                1. [Immediate mode](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec23)
                1. [No packets available](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec24)
                1. [Check hold buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec25)
                1. [Check store buffer](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec26)
                1. [Packets are available](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec27)
            1. [31.6. BPF Output](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec6)
                1. [bpfwrite Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec28)
                1. [Check device number](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec29)
                1. [Copy data into mbuf chain](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec30)
                1. [Queue packet](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev2sec31)
        1. [31.7. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec7)
            1. [31.7. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec7)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_37.html#ch31lev1sec8)
    1. [32. Raw IP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html)
        1. [32.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec1)
            1. [32.1. Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec1)
            1. [32.2. Code Introduction](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec2)
                1. [Global Variables](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec1)
                1. [Statistics](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec2)
            1. [32.3. Raw IP protosw Structure](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec3)
            1. [32.4. rip_init Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec4)
            1. [32.5. rip_input Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec5)
                1. [Save source IP address](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec3)
                1. [Search all raw IP PCBs for one or more matching entries](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec4)
                1. [Compare protocols](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec5)
                1. [Compare local and foreign IP addresses](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec6)
                1. [Pass copy of received datagram to processes](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec7)
                1. [Undeliverable datagram](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec8)
            1. [32.6. rip_output Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec6)
                1. [Kernel fills in IP header](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec9)
                1. [Caller fills in IP header: IP_HDRINCL socket option](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec10)
            1. [32.7. rip_usrreq Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec7)
                1. [Verify superuser](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec11)
                1. [Create Internet PCB and reserve buffer space](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev2sec12)
            1. [32.8. rip_ctloutput Function](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec8)
        1. [32.9. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec9)
            1. [32.9. Summary](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec9)
            1. [Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_38.html#ch32lev1sec10)
    1. [Epilogue](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_39.html)
    1. [A. Solutions to Selected Exercises](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html)
        1. [Chapter 1](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec1)
            1. [Chapter 1](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec1)
            1. [Chapter 2](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec2)
            1. [Chapter 3](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec3)
            1. [Chapter 4](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec4)
            1. [Chapter 5](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec5)
            1. [Chapter 6](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec6)
            1. [Chapter 7](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec7)
            1. [Chapter 8](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec8)
            1. [Chapter 9](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec9)
            1. [Chapter 10](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec10)
            1. [Chapter 11](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec11)
            1. [Chapter 12](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec12)
            1. [Chapter 13](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec13)
            1. [Chapter 14](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec14)
            1. [Chapter 15](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec15)
            1. [Chapter 16](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec16)
            1. [Chapter 17](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec17)
            1. [Chapter 18](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec18)
            1. [Chapter 19](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec19)
            1. [Chapter 20](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec20)
            1. [Chapter 21](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec21)
            1. [Chapter 22](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec22)
            1. [Chapter 23](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec23)
            1. [Chapter 24](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec24)
            1. [Chapter 25](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec25)
            1. [Chapter 26](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec26)
            1. [Chapter 27](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec27)
            1. [Chapter 28](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec28)
            1. [Chapter 29](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec29)
            1. [Chapter 30](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec30)
            1. [Chapter 31](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec31)
            1. [Chapter 32](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_40.html#app02lev1sec32)
    1. [B. Source Code Availability](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html)
        1. [URLs: Uniform Resource Locators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec1)
            1. [URLs: Uniform Resource Locators](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec1)
            1. [4.4BSD-Lite](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec2)
            1. [Operating Systems that Run the 4.4BSD-Lite Networking Software](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec3)
            1. [RFCs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec4)
            1. [GNU Software](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec5)
            1. [PPP Software](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec6)
            1. [mrouted Software](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec7)
            1. [ISODE Software](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_41.html#app03lev1sec8)
    1. [C. RFC 1122 Compliance](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html)
        1. [C.1. Link-Layer Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec1)
            1. [C.1. Link-Layer Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec1)
            1. [C.2. IP Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec2)
                1. [Multihoming](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec1)
                1. [Broadcast](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec2)
                1. [IP Interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec3)
            1. [C.3. IP Options Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec3)
                1. [Source Route Forwarding](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec4)
            1. [C.4. IP Fragmentation and Reassembly Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec4)
            1. [C.5. ICMP Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec5)
            1. [C.6. Multicasting Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec6)
            1. [C.7. IGMP Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec7)
            1. [C.8. Routing Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec8)
            1. [C.9. ARP Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec9)
            1. [C.10. UDP Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec10)
            1. [C.11. TCP Requirements](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev1sec11)
                1. [PSH Flag](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec5)
                1. [Window](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec6)
                1. [Urgent Data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec7)
                1. [TCP Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec8)
                1. [TCP Checksums](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec9)
                1. [Initial Sequence Number Selection](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec10)
                1. [Opening Connections](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec11)
                1. [Closing Connections](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec12)
                1. [Retransmissions](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec13)
                1. [Generating ACKs](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec14)
                1. [Sending Data](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec15)
                1. [Connection Failures](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec16)
                1. [Keepalive Packets](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec17)
                1. [IP Options](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec18)
                1. [Receiving ICMP Messages from IP](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec19)
                1. [Application Programming Interface](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_42.html#app04lev2sec20)
    1. [Bibliography](https://ebookreading.net/view/book/TCP%2FIP+Illustrated-EB020163354X_43.html)
