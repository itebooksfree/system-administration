![Cover image for Rootkits: Subverting the Windows Kernel](https://imgdetail.ebookreading.net/cover/cover/system_admin/EB0321294319.jpg)

[Rootkits: Subverting the Windows Kernel](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_1.html "Rootkits: Subverting the Windows Kernel")
====================================================================================================================

Author : [James Butler](https://ebookreading.net/search/author/James+Butler),[ Greg Hoglund](https://ebookreading.net/search/author/+Greg+Hoglund)

Release Date : 2005/07/01

ISBN : 0321294319

Topic : [System Administration](https://ebookreading.net/search/category/system-administration)

Book Description
-----------------

"It's imperative that everybody working in the field of cyber-security read this book to understand the growing threat of rootkits." --Mark Russinovich, editor, Windows IT Pro / Windows &amp; .NET Magazine
"This material is not only up-to-date, it defines up-to-date. It is truly cutting-edge. As the only book on the subject, Rootkits will be of interest to any Windows security researcher or security programmer. It's detailed, well researched and the technical information is excellent. The level of technical detail, research, and time invested in developing relevant examples is impressive. In one word: Outstanding." --Tony Bautts, Security Consultant; CEO, Xtivix, Inc.
"This book is an essential read for anyone responsible for Windows security. Security professionals, Windows system administrators, and programmers in general will want to understand the techniques used by rootkit authors. At a time when many IT and security professionals are still worrying about the latest e-mail virus or how to get all of this month's security patches installed, Mr. Hoglund and Mr. Butler open your eyes to some of the most stealthy and significant threats to the Windows operating system. Only by understanding these offensive techniques can you properly defend the networks and systems for which you are responsible." --Jennifer Kolde, Security Consultant, Author, and Instructor
"What's worse than being owned? Not knowing it. Find out what it means to be owned by reading Hoglund and Butler's first-of-a-kind book on rootkits. At the apex the malicious hacker toolset--which includes decompilers, disassemblers, fault-injection engines, kernel debuggers, payload collections, coverage tools, and flow analysis tools--is the rootkit. Beginning where Exploiting Software left off, this book shows how attackers hide in plain sight.  "Rootkits are extremely powerful and are the next wave of attack technology. Like other types of malicious code, rootkits thrive on stealthiness. They hide away from standard system observers, employing hooks, trampolines, and patches to get their work done. Sophisticated rootkits run in such a way that other programs that usually monitor machine behavior can't easily detect them. A rootkit thus provides insider access only to people who know that it is running and available to accept commands. Kernel rootkits can hide files and running processes to provide a backdoor into the target machine.  "Understanding the ultimate attacker's tool provides an important motivator for those of us trying to defend systems. No authors are better suited to give you a detailed hands-on understanding of rootkits than Hoglund and Butler. Better to own this book than to be owned." --Gary McGraw, Ph.D., CTO, Cigital, coauthor of Exploiting Software (2004) and Building Secure Software (2002), both from Addison-Wesley
"Greg and Jamie are unquestionably the go-to experts when it comes to subverting the Windows API and creating rootkits. These two masters come together to pierce the veil of mystery surrounding rootkits, bringing this information out of the shadows. Anyone even remotely interested in security for Windows systems, including forensic analysis, should include this book very high on their must-read list." --Harlan Carvey, author of Windows Forensics and Incident Recovery (Addison-Wesley, 2005)
Rootkits are the ultimate backdoor, giving hackers ongoing and virtually undetectable access to the systems they exploit. Now, two of the world's leading experts have written the first comprehensive guide to rootkits: what they are, how they work, how to build them, and how to detect them. Rootkit.com's Greg Hoglund and James Butler created and teach Black Hat's legendary course in rootkits. In this book, they reveal never-before-told offensive aspects of rootkit technology--learn how attackers can get in and stay in for years, without detection.
Hoglund and Butler show exactly how to subvert the Windows XP and Windows 2000 kernels, teaching concepts that are easily applied to virtually any modern operating system, from Windows Server 2003 to Linux and UNIX. They teach rootkit programming techniques that can be used for a wide range of software, from white hat security tools to operating system drivers and debuggers.
After reading this book, readers will be able to
Understand the role of rootkits in remote command/control and software eavesdropping
Build kernel rootkits that can make processes, files, and directories invisible
Master key rootkit programming techniques, including hooking, runtime patching, and directly manipulating kernel objects
Work with layered drivers to implement keyboard sniffers and file filters
Detect rootkits and build host-based intrusion prevention software that resists rootkit attacks
              
Table of Contents
-----------------

1. [Copyright](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_1.html)
    1. [Dedication](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_1.html#ded01)
1. [Praise for Rootkits](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_2.html)
1. [Preface](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_3.html)
    1. [Historical Background](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_3.html#pref02lev1sec1)
    1. [Target Audience](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_3.html#pref02lev1sec2)
    1. [Prerequisites](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_3.html#pref02lev1sec3)
    1. [Scope](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_3.html#pref02lev1sec4)
1. [Acknowledgments](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_4.html)
1. [About the Authors](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_5.html)
1. [About the Cover](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_6.html)
1. [1. Leave No Trace](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html)
    1. [Understanding Attackers’ Motives](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec1)
        1. [The Role of Stealth](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec1)
        1. [When Stealth Doesn’t Matter](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec2)
    1. [What Is a Rootkit?](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec2)
    1. [Why Do Rootkits Exist?](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec3)
        1. [Remote Command and Control](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec3)
        1. [Software Eavesdropping](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec4)
        1. [Legitimate Uses of Rootkits](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec5)
    1. [How Long Have Rootkits Been Around?](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec4)
    1. [How Do Rootkits Work?](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec5)
        1. [Patching](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec6)
        1. [Easter Eggs](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec7)
        1. [Spyware Modifications](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec8)
        1. [Source-Code Modification](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec9)
        1. [The Legality of Software Modification](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec10)
    1. [What a Rootkit Is Not](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec6)
        1. [A Rootkit Is Not an Exploit](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec11)
        1. [A Rootkit Is Not a Virus](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec12)
            1. [The Virus Problem](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev3sec1)
    1. [Rootkits and Software Exploits](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec7)
        1. [Why Exploits Are Still a Problem](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec13)
    1. [Offensive Rootkit Technologies](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec8)
        1. [HIPS](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec14)
        1. [NIDS](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec15)
        1. [Bypassing the IDS/IPS](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec16)
        1. [Bypassing Forensic Tools](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev2sec17)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_7.html#ch01lev1sec9)
1. [2. Subverting the Kernel](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html)
    1. [Important Kernel Components](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec1)
    1. [Rootkit Design](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec2)
    1. [Introducing Code into the Kernel](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec3)
    1. [Building the Windows Device Driver](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec4)
        1. [The Device Driver Development Kit](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec1)
        1. [The Build Environments](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec2)
        1. [The Files](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec3)
            1. [The SOURCES File](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev3sec1)
            1. [The MAKEFILE File](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev3sec2)
        1. [Running the Build Utility](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec4)
        1. [The Unload Routine](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec5)
    1. [Loading and Unloading the Driver](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec5)
    1. [Logging the Debug Statements](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec6)
    1. [Fusion Rootkits: Bridging User and Kernel Modes](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec7)
        1. [I/O Request Packets](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec6)
        1. [Creating a File Handle](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec7)
        1. [Adding a Symbolic Link](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec8)
    1. [Loading the Rootkit](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec8)
        1. [The Quick-and-Dirty Way to Load a Driver](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec9)
        1. [The Right Way to Load a Driver](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev2sec10)
    1. [Decompressing the .sys File from a Resource](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec9)
    1. [Surviving Reboot](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec10)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_8.html#ch02lev1sec11)
1. [3. The Hardware Connection](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html)
    1. [Ring Zero](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec1)
    1. [Tables, Tables, and More Tables](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec2)
    1. [Memory Pages](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec3)
        1. [Memory Access Check Details](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec1)
        1. [Paging and Address Translation](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec2)
        1. [Page-Table Lookups](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec3)
        1. [The Page-Directory Entry](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec4)
        1. [The Page-Table Entry](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec5)
        1. [Read-Only Access to Some Important Tables](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec6)
        1. [Multiple Processes, Multiple Page Directories](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec7)
        1. [Processes and Threads](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec8)
    1. [The Memory Descriptor Tables](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec4)
        1. [The Global Descriptor Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec9)
        1. [The Local Descriptor Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec10)
        1. [Code Segments](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec11)
        1. [Call Gates](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec12)
    1. [The Interrupt Descriptor Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec5)
        1. [Other Types of Gates](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec13)
    1. [The System Service Dispatch Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec6)
    1. [The Control Registers](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec7)
        1. [Control Register Zero (CR0)](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec14)
        1. [Other Control Registers](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec15)
        1. [The EFlags Register](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev2sec16)
    1. [Multiprocessor Systems](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec8)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_9.html#ch03lev1sec9)
1. [4. The Age-Old Art of Hooking](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html)
    1. [Userland Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev1sec1)
        1. [Import Address Table Hooking](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec1)
        1. [Inline Function Hooking](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec2)
        1. [Injecting a DLL into Userland Processes](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec3)
            1. [Injecting a DLL using the Registry](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec1)
            1. [Injecting a DLL using Windows Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec2)
            1. [Injecting a DLL using Remote Threads](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec3)
    1. [Kernel Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev1sec2)
        1. [Hooking the System Service Descriptor Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec4)
            1. [Changing the SSDT Memory Protections](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec4)
            1. [Hooking the SSDT](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec5)
            1. [Example: Hiding Processes using an SSDT Hook](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec6)
        1. [Hooking the Interrupt Descriptor Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec5)
            1. [SYSENTER](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec7)
        1. [Hooking the Major I/O Request Packet Function Table in the Device Driver Object](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec6)
            1. [Finding the Driver IRP Function Table](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec8)
            1. [IRP Hook Function](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec9)
            1. [IRP Completion Routines](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev3sec10)
    1. [A Hybrid Hooking Approach](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev1sec3)
        1. [Getting into a Process’s Address Space](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec7)
        1. [Memory Space for Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev2sec8)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_10.html#ch04lev1sec4)
1. [5. Runtime Patching](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html)
    1. [Detour Patching](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev1sec1)
        1. [Rerouting the Control Flow Using MigBot](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev2sec1)
        1. [Checking for Function Bytes](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev2sec2)
        1. [Keeping Track of the Overwritten Instructions](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev2sec3)
        1. [Using NonPagedPool Memory](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev2sec4)
        1. [Runtime Address Fixups](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev2sec5)
    1. [Jump Templates](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev1sec2)
        1. [The Interrupt Hook Example](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev2sec6)
    1. [Variations on the Method](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev1sec3)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_11.html#ch05lev1sec4)
1. [6. Layered Drivers](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_12.html)
    1. [A Keyboard Sniffer](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_12.html#ch06lev1sec1)
        1. [I/O Request Packet (IRP) and Stack Locations](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_12.html#ch06lev2sec1)
    1. [The KLOG Rootkit: A Walk-through](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_12.html#ch06lev1sec2)
    1. [File Filter Drivers](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_12.html#ch06lev1sec3)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_12.html#ch06lev1sec4)
1. [7. Direct Kernel Object Manipulation](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html)
    1. [DKOM Benefits and Drawbacks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev1sec1)
    1. [Determining the Version of the Operating System](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev1sec2)
        1. [User-Mode Self-Determination](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec1)
        1. [Kernel-Mode Self-Determination](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec2)
        1. [Querying the Operating System Version in the Registry](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec3)
    1. [Communicating with the Device Driver from Userland](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev1sec3)
    1. [Hiding with DKOM](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev1sec4)
        1. [Process Hiding](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec4)
        1. [Device-Driver Hiding](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec5)
        1. [Synchronization Issues](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec6)
    1. [Token Privilege and Group Elevation with DKOM](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev1sec5)
        1. [Modifying a Process Token](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec7)
            1. [Finding the Process Token](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev3sec1)
            1. [Modifying the Process Token](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev3sec2)
            1. [Adding Privileges to a Process Token](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev3sec3)
            1. [Adding SIDs to a Process Token](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev3sec4)
        1. [Faking out the Windows Event Viewer](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev2sec8)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_13.html#ch07lev1sec6)
1. [8. Hardware Manipulation](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html)
    1. [Why Hardware?](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev1sec1)
    1. [Modifying the Firmware](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev1sec2)
    1. [Accessing the Hardware](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev1sec3)
        1. [Hardware Addresses](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec1)
        1. [Accessing Hardware Is Not Like Accessing RAM](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec2)
        1. [Timing Considerations](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec3)
        1. [The I/O Bus](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec4)
        1. [Accessing the BIOS](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec5)
        1. [Accessing PCI and PCMCIA Devices](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec6)
    1. [Example: Accessing the Keyboard Controller](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev1sec4)
        1. [The 8259 Keyboard Controller](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec7)
        1. [Changing the LED Indicators](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec8)
        1. [Hard Reboot](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec9)
        1. [Keystroke Monitor](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev2sec10)
    1. [How Low Can You Go? Microcode Update](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev1sec5)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_14.html#ch08lev1sec6)
1. [9. Covert Channels](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html)
    1. [Remote Command, Control, and Exfiltration of Data](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec1)
    1. [Disguised TCP/IP Protocols](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec2)
        1. [Beware of Traffic Patterns](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec1)
        1. [Don’t Send Data “in the Clear”](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec2)
            1. [Steganography](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev3sec1)
        1. [Use Time to Your Advantage](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec3)
        1. [Hide Under DNS Requests](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec4)
        1. [“Stego” on ASCII Payloads](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec5)
        1. [Use Other TCP/IP Channels](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec6)
    1. [Kernel TCP/IP Support for Your Rootkit Using TDI](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec3)
        1. [Build the Address Structure](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec7)
        1. [Create a Local Address Object](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec8)
        1. [Create a TDI Endpoint with Context](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec9)
        1. [Associate an Endpoint with a Local Address](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec10)
        1. [Connect to a Remote Server (Send the TCP Handshake)](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec11)
        1. [Send Data to a Remote Server](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec12)
    1. [Raw Network Manipulation](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec4)
        1. [Implementing Raw Sockets on Windows XP](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec13)
        1. [Binding to an Interface](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec14)
        1. [Sniffing with Raw Sockets](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec15)
        1. [Promiscuous Sniffing with Raw Sockets](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec16)
        1. [Sending Packets with Raw Sockets](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec17)
        1. [Forging the Source](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec18)
        1. [Bouncing Packets](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec19)
    1. [Kernel TCP/IP Support for Your Rootkit Using NDIS](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec5)
        1. [Registering the Protocol](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec20)
        1. [The Protocol Driver Callbacks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec21)
        1. [Moving Whole Packets](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec22)
    1. [Host Emulation](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec6)
        1. [Creating Your MAC Address](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec23)
        1. [Handling ARP](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec24)
        1. [The IP Gateway](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec25)
        1. [Sending a Packet](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev2sec26)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_15.html#ch09lev1sec7)
1. [10. Rootkit Detection](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html)
    1. [Detecting Presence](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev1sec1)
        1. [Guarding the Doors](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev2sec1)
        1. [Scanning the “Rooms”](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev2sec2)
        1. [Looking for Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev2sec3)
            1. [Getting the Address Ranges of Kernel Modules](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec1)
            1. [Finding SSDT Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec2)
            1. [Finding Inline Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec3)
            1. [Finding IRP Handler Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec4)
            1. [Finding IAT Hooks](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec5)
            1. [Tracing Execution](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec6)
    1. [Detecting Behavior](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev1sec2)
        1. [Detecting Hidden Files and Registry Keys](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev2sec4)
        1. [Detecting Hidden Processes](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev2sec5)
            1. [Hooking SwapContext](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec7)
            1. [Different Sources of Process Listings](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev3sec8)
    1. [Conclusion](https://ebookreading.net/view/book/Rootkits%3A+Subverting+the+Windows+Kernel-EB0321294319_16.html#ch10lev1sec3)
