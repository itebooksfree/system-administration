![Cover image for Understanding Linux Network Internals](https://imgdetail.ebookreading.net/cover/cover/system_admin/EB0596002556.jpg)

[Understanding Linux Network Internals](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_1.html "Understanding Linux Network Internals")
====================================================================================================================

Author : [Christian Benvenuti](https://ebookreading.net/search/author/Christian+Benvenuti)

Release Date : 2005/12/01

ISBN : 0596002556

Topic : [System Administration](https://ebookreading.net/search/category/system-administration)

Book Description
-----------------

If you've ever wondered how Linux carries out the complicated tasks assigned to it by the IP protocols -- or if you just want to learn about modern networking through real-life examples -- Understanding Linux Network Internals is for you.
Like the popular O'Reilly book, Understanding the Linux Kernel, this book clearly explains the underlying concepts and teaches you how to follow the actual C code that implements it. Although some background in the TCP/IP protocols is helpful, you can learn a great deal from this text about the protocols themselves and their uses. And if you already have a base knowledge of C, you can use the book's code walkthroughs to figure out exactly what this sophisticated part of the Linux kernel is doing.
Part of the difficulty in understanding networks -- and implementing them -- is that the tasks are broken up and performed at many different times by different pieces of code. One of the strengths of this book is to integrate the pieces and reveal the relationships between far-flung functions and data structures.  Understanding Linux Network Internals is both a big-picture discussion and a no-nonsense guide to the details of Linux networking.  Topics include:
Key problems with networkingNetwork interface card (NIC) device driversSystem initializationLayer 2 (link-layer) tasks and implementationLayer 3 (IPv4) tasks and implementationNeighbor infrastructure and protocols (ARP)BridgingRoutingICMPAuthor Christian Benvenuti, an operating system designer specializing in networking, explains much more than how Linux code works.  He shows the purposes of major networking features and the trade-offs involved in choosing one solution over another.  A large number of flowcharts and other diagrams enhance the book's understandability.
              
Table of Contents
-----------------

1. [Preface](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html)
    1. [The Audience for This Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [Background Information](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [Organization of the Material](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
        1. [What Is Not Covered](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [Conventions Used in This Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [Using Code Examples](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [We’d Like to Hear from You](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [Safari Enabled](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
    1. [Acknowledgments](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_3.html#understandlni-PREFA)
1. [I. General Background](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_4.html)
    1. [1. Introduction](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html)
        1. [1.1. Basic Terminology](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
        1. [1.2. Common Coding Patterns](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.1. Memory Caches](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.2. Caching and Hash Tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.3. Reference Counts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.4. Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.5. Function Pointers and Virtual Function                                                   Tables (VFTs)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.6. goto Statements](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.7. Vector Definitions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.8. Conditional Directives (#ifdef and                                                   family)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.9. Compile-Time Optimization for Condition                                                   Checks](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.10. Mutual Exclusion](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.11. Conversions Between Host and Network                                                   Order](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.12. Catching Bugs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.13. Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.2.14. Measuring Time](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
        1. [1.3. User-Space Tools](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
        1. [1.4. Browsing the Source Code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
            1. [1.4.1. Dead Code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
        1. [1.5. When a Feature Is Offered as a                                                   Patch](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_5.html#understandlni-CHP-1)
    1. [2. Critical Data                                                   Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html)
        1. [2.1. The Socket Buffer: sk_buff Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.1.1. Networking Options and Kernel                                                   Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.1.2. Layout Fields](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.1.3. General Fields](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.1.4. Feature-Specific Fields](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.1.5. Management Functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.1.5.1. Allocating memory: alloc_skb and                                                   dev_alloc_skb](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.1.5.2. Freeing memory: kfree_skb and                                                   dev_kfree_skb](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.1.5.3. Data reservation and alignment:                                                   skb_reserve, skb_put, skb_push, and                                                   skb_pull](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.1.5.4. The skb_shared_info structure and the                                                   skb_shinfo function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.1.5.5. Cloning and copying buffers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.1.5.6. List management functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
        1. [2.2. net_device Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.1. Identifiers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.2. Configuration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.2.2.1. Interface types and ports](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
                1. [2.2.2.2. Promiscuous mode](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.3. Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.4. Device Status](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.5. List Management](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.6. Link Layer Multicast](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.7. Traffic Management](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.8. Feature Specific](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.9. Generic](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
            1. [2.2.10. Function Pointers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
        1. [2.3. Files Mentioned in This Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_6.html#understandlni-CHP-2)
    1. [3. User-Space-to-Kernel                                                   Interface](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html)
        1. [3.1. Overview](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
        1. [3.2. procfs Versus sysctl](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
            1. [3.2.1. procfs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
            1. [3.2.2. sysctl: Directory /proc/sys](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
                1. [3.2.2.1. Examples of ctl_table                                                   initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
                1. [3.2.2.2. Registering a file in /proc/sys](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
                1. [3.2.2.3. Core networking files and                                                   directories](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
        1. [3.3. ioctl](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
        1. [3.4. Netlink](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
        1. [3.5. Serializing Configuration Changes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_7.html#understandlni-CHP-3)
1. [II. System                                                   Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_8.html)
    1. [4. Notification Chains](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html)
        1. [4.1. Reasons for Notification Chains](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.2. Overview](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.3. Defining a Chain](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.4. Registering with a Chain](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.5. Notifying Events on a Chain](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.6. Notification Chains for the Networking                                                   Subsystems](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
            1. [4.6.1. Wrappers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
            1. [4.6.2. Examples](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.7. Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.8. Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
        1. [4.9. Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_9.html#understandlni-CHP-4)
    1. [5. Network Device                                                   Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html)
        1. [5.1. System Initialization Overview](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.2. Device Registration and                                                   Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.3. Basic Goals of NIC Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.4. Interaction Between Devices and Kernel](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
            1. [5.4.1. Hardware Interrupts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
                1. [5.4.1.1. Interrupt types](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
                1. [5.4.1.2. Interrupt sharing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
                1. [5.4.1.3. Organization of IRQs to handler                                                   mappings](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.5. Initialization Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.6. Module Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.7. Initializing the Device Handling Layer:                                                   net_dev_init](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
            1. [5.7.1. Legacy Code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.8. User-Space Helpers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
            1. [5.8.1. kmod](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
            1. [5.8.2. Hotplug](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
                1. [5.8.2.1. /sbin/hotplug](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.9. Virtual Devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
            1. [5.9.1. Examples of Virtual Devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
            1. [5.9.2. Interaction with the Kernel Network                                                   Stack](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.10.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.11.                                                   Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
        1. [5.12.                                                   Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_10.html#understandlni-CHP-5)
    1. [6. The PCI Layer and                                                   Network Interface Cards](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html)
        1. [6.1. Data Structures Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.2. Registering a PCI NIC Device Driver](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.3. Power Management and Wake-on-LAN](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.4. Example of PCI NIC Driver                                                   Registration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.5. The Big Picture](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.6. Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.7. Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
        1. [6.8. Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_11.html#understandlni-CHP-6)
    1. [7. Kernel Infrastructure                                                   for Component Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html)
        1. [7.1. Boot-Time Kernel Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.1.1. Registering a Keyword](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.1.2. Two-Pass Parsing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.1.3. .init.setup Memory Section](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.1.4. Use of Boot Options to Configure Network                                                   Devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.2. Module Initialization Code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.2.1. Old Model: Conditional Code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.2.2. New Model: Macro-Based Tagging](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.3. Optimized Macro-Based Tagging](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.3.1. Initialization Macros for Device                                                   Initialization Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.4. Boot-Time Initialization Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.4.1. xxx_initcall Macros](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
                1. [7.4.1.1. Example of _ _initcall and _ _exitcall                                                   routines: modules](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
                1. [7.4.1.2. Example of dependency between                                                   initialization routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
                1. [7.4.1.3. Legacy code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.5. Memory Optimizations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.5.1. _ _init and _ _exit Macros](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.5.2. xxx_initcall and _ _exitcall                                                   Sections](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.5.3. Other Optimizations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
            1. [7.5.4. Dynamic Macros’ Definition](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.6. Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.7. Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
        1. [7.8. Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_12.html#understandlni-CHP-7)
    1. [8. Device Registration and                                                   Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html)
        1. [8.1. When a Device Is Registered](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.2. When a Device Is Unregistered](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.3. Allocating net_device Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.4. Skeleton of NIC Registration and                                                   Unregistration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.5. Device Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.5.1. Device Driver Initializations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.5.2. Device Type Initialization: xxx_setup                                                   Functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.5.3. Optional Initializations and Special                                                   Cases](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.6. Organization of net_device Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.6.1. Lookups](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.7. Device State](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.7.1. Queuing Discipline State](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.7.2. Registration State](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.8. Registering and Unregistering Devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.8.1. Split Operations: netdev_run_todo](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.8.2. Device Registration Status                                                   Notification](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.8.2.1. netdev_chain notification chain](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.8.2.2. RTnetlink link notifications](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.9. Device Registration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.9.1. register_netdevice Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.10.                                                   Device Unregistration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.10.1. unregister_netdevice Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.10.2. Reference Counts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.10.2.1. Function netdev_wait_allrefs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.11.                                                   Enabling and Disabling a Network Device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.12.                                                   Updating the Device Queuing Discipline State](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.12.1. Interactions with Power Management](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.12.1.1. Suspending a device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.12.1.2. Resuming a device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.12.2. Link State Change Detection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.12.2.1. Scheduling and processing link state                                                   change events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.12.2.2. Linkwatch flags](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.13.                                                   Configuring Device-Related Information from User                                                   Space](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.13.1. Ethtool](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
                1. [8.13.1.1. Drivers that do not support                                                   ethtool](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
            1. [8.13.2. Media Independent Interface                                                   (MII)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.14.                                                   Virtual Devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.15.                                                   Locking](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.16.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.17.                                                   Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
        1. [8.18.                                                   Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_13.html#understandlni-CHP-8)
1. [III. Transmission and                                                   Reception](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_14.html)
    1. [9. Interrupts and Network                                                   Drivers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html)
        1. [9.1. Decisions and Traffic Direction](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
        1. [9.2. Notifying Drivers When Frames Are                                                   Received](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.2.1. Polling](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.2.2. Interrupts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.2.3. Processing Multiple Frames During an                                                   Interrupt](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.2.4. Timer-Driven Interrupts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.2.5. Combinations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.2.6. Example](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
        1. [9.3. Interrupt Handlers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.1. Reasons for Bottom Half Handlers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.2. Bottom Halves Solutions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.3. Concurrency and Locking](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.4. Preemption](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.5. Bottom-Half Handlers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
                1. [9.3.5.1. Bottom-half handlers in kernel                                                   2.2](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
                1. [9.3.5.2. Bottom-half handlers in kernel 2.4 and                                                   above: the introduction of the softirq](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.6. Tasklets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.7. Softirq Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.8. Pending softirq Handling](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
                1. [9.3.8.1. _ _do_softirq function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.9. Per-Architecture Processing of                                                   softirq](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.10. ksoftirqd Kernel Threads](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
                1. [9.3.10.1. Starting the threads](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.11. Tasklet Processing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.3.12. How the Networking Code Uses                                                   softirqs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
        1. [9.4. softnet_data Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.4.1. Fields of softnet_data](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
            1. [9.4.2. Initialization of softnet_data](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_15.html#understandlni-CHP-9)
    1. [10. Frame Reception](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html)
        1. [10.1.                                                   Interactions with Other Features](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
        1. [10.2.                                                   Enabling and Disabling a Device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
        1. [10.3.                                                   Queues](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
        1. [10.4.                                                   Notifying the Kernel of Frame Reception: NAPI and                                                   netif_rx](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.4.1. Introduction to the New API                                                   (NAPI)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.4.2. net_device Fields Used by NAPI](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.4.3. net_rx_action and NAPI](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.4.4. Old Versus New Driver Interfaces](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.4.5. Manipulating poll_list](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
        1. [10.5.                                                   Old Interface Between Device Drivers and Kernel:                                                   First Part of netif_rx](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.5.1. Initial Tasks of netif_rx](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.5.2. Managing Queues and Scheduling the Bottom                                                   Half](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
        1. [10.6.                                                   Congestion Management](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.6.1. Congestion Management in                                                   netif_rx](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.6.2. Average Queue Length and Congestion-Level                                                   Computation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
        1. [10.7.                                                   Processing the NET_RX_SOFTIRQ: net_rx_action](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.7.1. Backlog Processing: The process_backlog                                                   Poll Virtual Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
            1. [10.7.2. Ingress Frame Processing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
                1. [10.7.2.1. Handling special features](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_16.html#understandlni-CHP-1)
    1. [11. Frame Transmission](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html)
        1. [11.1.                                                   Enabling and Disabling Transmissions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
            1. [11.1.1. Scheduling a Device for                                                   Transmission](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
            1. [11.1.2. Queuing Discipline Interface](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
                1. [11.1.2.1. qdisc_restart function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
            1. [11.1.3. dev_queue_xmit Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
                1. [11.1.3.1. Queueful devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
                1. [11.1.3.2. Queueless devices](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
            1. [11.1.4. Processing the NET_TX_SOFTIRQ:                                                   net_tx_action](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
                1. [11.1.4.1. Watchdog timer](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_17.html#understandlni-CHP-1)
    1. [12. General and Reference                                                   Material About Interrupts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_18.html)
        1. [12.1.                                                   Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_18.html#understandlni-CHP-1)
        1. [12.2.                                                   Tuning via /proc and sysfs Filesystems](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_18.html#understandlni-CHP-1)
        1. [12.3.                                                   Functions and Variables Featured in This Part of                                                   the Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_18.html#understandlni-CHP-1)
        1. [12.4.                                                   Files and Directories Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_18.html#understandlni-CHP-1)
    1. [13. Protocol Handlers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html)
        1. [13.1.                                                   Overview of Network Stack](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.1.1. The Big Picture](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.1.2. Link Layer Choices for Ethernet (LLC and                                                   SNAP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.1.3. How the Network Stack Operates](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.2.                                                   Executing the Right Protocol Handler](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.2.1. Special Media Encapsulation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.3.                                                   Protocol Handler Organization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.4.                                                   Protocol Handler Registration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.5.                                                   Ethernet Versus IEEE 802.3 Frames](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.5.1. Setting the Packet Type](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.5.2. Setting the Ethernet Protocol and                                                   Length](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.5.3. Logical Link Control (LLC)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
                1. [13.5.3.1. The IPX case](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
                1. [13.5.3.2. Linux’s LLC implementation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
                1. [13.5.3.3. Processing ingress LLC frames](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
            1. [13.5.4. Subnetwork Access Protocol                                                   (SNAP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.6.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.7.                                                   Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
        1. [13.8.                                                   Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_19.html#understandlni-CHP-1)
1. [IV. Bridging](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_20.html)
    1. [14. Bridging: Concepts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html)
        1. [14.1.                                                   Repeaters, Bridges, and Routers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
        1. [14.2.                                                   Bridges Versus Switches](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
        1. [14.3.                                                   Hosts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
        1. [14.4.                                                   Merging LANs with Bridges](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
        1. [14.5.                                                   Bridging Different LAN Technologies](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
        1. [14.6.                                                   Address Learning](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
            1. [14.6.1. Broadcast and Multicast                                                   Addresses](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
            1. [14.6.2. Aging](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
        1. [14.7.                                                   Multiple Bridges](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
            1. [14.7.1. Bridging Loops](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
            1. [14.7.2. Loop-Free Topologies](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
            1. [14.7.3. Defining a Loop-Free Topology](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_21.html#understandlni-CHP-1)
    1. [15. Bridging: The Spanning                                                   Tree Protocol](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html)
        1. [15.1.                                                   Basic Terminology](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.2.                                                   Example of Hierarchical Switched L2                                                   Topology](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.3.                                                   Basic Elements of the Spanning Tree Protocol](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.3.1. Root Bridge](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.3.2. Designated Bridges](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.3.3. Spanning Tree Ports](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
                1. [15.3.3.1. Port states](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
                1. [15.3.3.2. Port roles](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.4.                                                   Bridge and Port IDs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.5.                                                   Bridge Protocol Data Units (BPDUs)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.5.1. Configuration BPDU](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.5.2. Priority Vector](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.5.3. When to Transmit Configuration                                                   BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.5.4. BPDU Aging](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.6.                                                   Defining the Active Topology](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.6.1. Root Bridge Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.6.2. Root Port Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.6.3. Designated Port Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.6.4. Examples of STP in Action](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.7.                                                   Timers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.7.1. Avoiding Temporary Loops](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.8.                                                   Topology Changes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.8.1. Short Aging Timer](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.8.2. Letting All Bridges Know About a Topology                                                   Change](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.8.3. Example of a Topology Change](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.9.                                                   BPDU Encapsulation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.10. Transmitting Configuration BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.11. Processing Ingress Frames](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.11.1. Ingress BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.11.2. Ingress Configuration BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.12. Convergence Time](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
        1. [15.13. Overview of Newer Spanning Tree                                                   Protocols](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.13.1. Rapid Spanning Tree Protocol                                                   (RSTP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
            1. [15.13.2. Multiple Spanning Tree Protocol                                                   (MSTP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_22.html#understandlni-CHP-1)
    1. [16. Bridging: Linux                                                   Implementation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html)
        1. [16.1.                                                   Bridge Device Abstraction](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.2.                                                   Important Data Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.3.                                                   Initialization of Bridging Code](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.4.                                                   Creating Bridge Devices and Bridge Ports](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.5.                                                   Creating a New Bridge Device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.6.                                                   Bridge Device Setup Routine](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.7.                                                   Deleting a Bridge](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.8.                                                   Adding Ports to a Bridge](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.8.1. Deleting a Bridge Port](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.9.                                                   Enabling and Disabling a Bridge Device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.10. Enabling and Disabling a Bridge                                                   Port](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.11. Changing State on a Bridge Port](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.12. The Big Picture](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.13. Forwarding Database](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.13.1. Lookups](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.13.2. Reference Counts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.13.3. Adding, Updating, and Removing                                                   Entries](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.13.4. Aging](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.14. Handling Ingress Traffic](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.14.1. Data Frames Versus BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.14.2. Processing Data Frames](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.15. Transmitting on a Bridge Device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.16. Spanning Tree Protocol (STP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.1. Key Spanning Tree Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.2. Bridge IDs and Port IDs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.3. Enabling the Spanning Tree Protocol on a                                                   Bridge Device](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.4. Processing Ingress BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.5. Transmitting BPDUs](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.6. Configuration Updates](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.7. Root Bridge Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
                1. [16.16.7.1. Becoming the root bridge](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
                1. [16.16.7.2. Giving up the root bridge                                                   role](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.8. Timers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
            1. [16.16.9. Handling Topology Changes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
        1. [16.17. netdevice Notification Chain](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_23.html#understandlni-CHP-1)
    1. [17. Bridging:                                                   Miscellaneous Topics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html)
        1. [17.1.                                                   User-Space Configuration Tools](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.1.1. Handling Configuration Changes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.1.2. Old Interface Versus New                                                   Interface](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.1.3. Creating Bridge Devices and Bridge                                                   Ports](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.1.4. Configuring Bridge Devices and                                                   Ports](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
        1. [17.2.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
        1. [17.3.                                                   Tuning via /sys Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
        1. [17.4.                                                   Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
        1. [17.5.                                                   Data Structures Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.5.1. bridge_id Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.5.2. net_bridge_fdb_entry Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.5.3. net_bridge_port Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
            1. [17.5.4. net_bridge Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
        1. [17.6.                                                   Functions and Variables Featured in This Part of                                                   the Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
        1. [17.7.                                                   Files and Directories Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_24.html#understandlni-CHP-1)
1. [V. Internet Protocol                                                   Version 4 (IPv4)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_25.html)
    1. [18. Internet Protocol                                                   Version 4 (IPv4): Concepts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html)
        1. [18.1.                                                   IP Protocol: The Big Picture](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
        1. [18.2.                                                   IP Header](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
        1. [18.3.                                                   IP Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.3.1. “End of Option List” and “No Operation”                                                   Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.3.2. Source Route Option](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.3.3. Record Route Option](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.3.4. Timestamp Option](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.3.5. Router Alert Option](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
        1. [18.4.                                                   Packet Fragmentation/Defragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.4.1. Effect of Fragmentation on Higher                                                   Layers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.4.2. IP Header Fields Used by                                                   Fragmentation/Defragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.4.3. Examples of Problems with                                                   Fragmentation/Defragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
                1. [18.4.3.1. Retransmissions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
                1. [18.4.3.2. Associating fragments with their IP                                                   packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
                1. [18.4.3.3. Example of IP ID generation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
                1. [18.4.3.4. Example of unsolvable defragmentation                                                   problem: NAT](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.4.4. Path MTU Discovery](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
        1. [18.5.                                                   Checksums](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.5.1. APIs for Checksum Computation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
            1. [18.5.2. Changes to the L4 Checksum](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_26.html#understandlni-CHP-1)
    1. [19. Internet Protocol                                                   Version 4 (IPv4): Linux Foundations and                                                   Features](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html)
        1. [19.1.                                                   Main IPv4 Data Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.1.1. Checksum-Related Fields from sk_buff and                                                   net_device Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.1.1.1. net_device structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.1.1.2. sk_buff structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
        1. [19.2.                                                   General Packet Handling](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.2.1. Protocol Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.2.2. Interaction with Netfilter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.2.3. Interaction with the Routing                                                   Subsystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.2.4. Processing Input IP Packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.2.5. The ip_rcv_finish Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
        1. [19.3.                                                   IP Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.3.1. Option Processing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
            1. [19.3.2. Option Parsing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.3.2.1. Option: strict and loose Source                                                   Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.3.2.2. Option: Record Route](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.3.2.3. Option: Timestamp](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.3.2.4. Option: Router Alert](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
                1. [19.3.2.5. Handling parsing errors](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_27.html#understandlni-CHP-1)
    1. [20. Internet Protocol                                                   Version 4 (IPv4): Forwarding and Local                                                   Delivery](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html)
        1. [20.1.                                                   Forwarding](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html#understandlni-CHP-2)
            1. [20.1.1. ICMP Redirect](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html#understandlni-CHP-2)
            1. [20.1.2. ip_forward Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html#understandlni-CHP-2)
            1. [20.1.3. ip_forward_finish Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html#understandlni-CHP-2)
            1. [20.1.4. dst_output Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html#understandlni-CHP-2)
        1. [20.2.                                                   Local Delivery](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_28.html#understandlni-CHP-2)
    1. [21. Internet Protocol                                                   Version 4 (IPv4): Transmission](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html)
        1. [21.1.                                                   Key Functions That Perform Transmission](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.1. Multicast Traffic](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.2. Relevant Socket Data Structures for Local                                                   Traffic](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.3. The ip_queue_xmit Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.3.1. Setting the route](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.3.2. Building the IP header](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.4. The ip_append_data Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.1. Basic memory allocation and buffer                                                   organization for ip_append_data](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.2. Memory allocation and buffer                                                   organization for ip_append_data with Scatter                                                   Gather I/O](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.3. Key routines for handling fragmented                                                   buffers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.4. Further handling of the                                                   buffers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.5. Setting the context](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.6. Getting ready for fragment                                                   generation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.7. Copying data into the fragments:                                                   getfrag](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.8. Buffer allocation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.9. Main loop](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
                1. [21.1.4.10. L4 checksum](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.5. The ip_append_page Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.6. The ip_push_pending_frames                                                   Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.7. Putting Together the Transmission                                                   Functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
            1. [21.1.8. Raw Sockets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
        1. [21.2.                                                   Interface to the Neighboring Subsystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_29.html#understandlni-CHP-2)
    1. [22. Internet Protocol                                                   Version 4 (IPv4): Handling Fragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html)
        1. [22.1.                                                   IP Fragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.1.1. Functions Involved with IP                                                   Fragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.1.2. The ip_fragment Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.1.3. Slow Fragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.1.4. Fast Fragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
        1. [22.2.                                                   IP Defragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.1. Organization of the IP Fragments Hash                                                   Table](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.2. Key Issues in Defragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.3. Functions Involved with                                                   Defragmentation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.4. New ipq Instance Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.5. The ip_defrag Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.6. The ip_frag_queue Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
                1. [22.2.6.1. Handling overlaps](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
                1. [22.2.6.2. L4 checksum](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.7. Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
            1. [22.2.8. Hash Table Reorganization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_30.html#understandlni-CHP-2)
    1. [23. Internet Protocol                                                   Version 4 (IPv4): Miscellaneous Topics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html)
        1. [23.1.                                                   Long-Living IP Peer Information](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.1.1. Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.1.2. Lookups](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.1.3. How the IP Layer Uses inet_peer                                                   Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.1.4. Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.2.                                                   Selecting the IP Header’s ID Field](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.3.                                                   IP Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.4.                                                   IP Configuration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.4.1. Main Functions That Manipulate IP                                                   Addresses and Configuration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.4.2. Change Notification: rtmsg_ifa](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.4.3. inetaddr_chain Notification                                                   Chain](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.4.4. IP Configuration via ip](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.4.5. IP Configuration via ifconfig](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.5.                                                   IP-over-IP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.6.                                                   IPv4: What’s Wrong with It?](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.7.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.8.                                                   Data Structures Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.1. iphdr Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.2. ip_options Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.3. ipcm_cookie Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.4. ipq Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.5. inet_peer Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.6. ipstats_mib Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.7. in_device Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.8. in_ifaddr Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.9. ipv4_devconf Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.10. ipv4_config Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.11. cork Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
            1. [23.8.12. skb_frag_t Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.9.                                                   Functions and Variables Featured in This Part of                                                   the Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
        1. [23.10. Files and Directories Featured in This                                                   Part of the Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_31.html#understandlni-CHP-2)
    1. [24. Layer Four Protocol                                                   and Raw IP Handling](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html)
        1. [24.1.                                                   Available L4 Protocols](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
        1. [24.2.                                                   L4 Protocol Registration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
            1. [24.2.1. Registration: inet_add_protocol and                                                   inet_del_protocol](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
        1. [24.3.                                                   L3 to L4 Delivery: ip_local_deliver_finish](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
            1. [24.3.1. Raw Sockets and Raw IP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
            1. [24.3.2. Delivering Raw Input Datagrams to the                                                   Recipient Application](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
            1. [24.3.3. IPsec](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
        1. [24.4.                                                   IPv4 Versus IPv6](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
        1. [24.5.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
        1. [24.6.                                                   Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
        1. [24.7.                                                   Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_32.html#understandlni-CHP-2)
    1. [25. Internet Control                                                   Message Protocol (ICMPv4)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html)
        1. [25.1.                                                   ICMP Header](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.2.                                                   ICMP Payload](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.3.                                                   ICMP Types](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.1. ICMP_ECHO and ICMP_ECHOREPLY](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.2. ICMP_DEST_UNREACH](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.3. ICMP_SOURCE_QUENCH](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.4. ICMP_REDIRECT](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.5. ICMP_TIME_EXCEEDED](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.6. ICMP_PARAMETERPROB](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.7. ICMP_TIMESTAMP and                                                   ICMP_TIMESTAMPREPLY](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.8. ICMP_INFO_REQUEST and                                                   ICMP_INFO_REPLY](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.3.9. ICMP_ADDRESS and                                                   ICMP_ADDRESSREPLY](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.4.                                                   Applications of the ICMP Protocol](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.4.1. ping](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.4.2. traceroute](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.5.                                                   The Big Picture](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.6.                                                   Protocol Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.7.                                                   Data Structures Featured in This Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.7.1. icmphdr Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.7.2. icmp_control Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.7.3. icmp_bxm Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.8.                                                   Transmitting ICMP Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.1. Transmitting ICMP Error Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.2. Replying to Ingress ICMP                                                   Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.3. Rate Limiting](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.4. Implementation of Rate Limiting](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.5. Receiving ICMP Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.6. Processing ICMP_ECHO and ICMP_ECHOREPLY                                                   Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.7. Processing the Common ICMP                                                   Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.8. Processing ICMP_REDIRECT                                                   Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.9. Processing ICMP_TIMESTAMP and                                                   ICMP_TIMESTAMPREPLY Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
            1. [25.8.10. Processing ICMP_ADDRESS and                                                   ICMP_ADDRESSREPLY Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.9.                                                   ICMP Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.10. Passing Error Notifications to the                                                   Transport Layer](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.11. Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.12. Functions and Variables Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
        1. [25.13. Files and Directories Featured in This                                                   Chapter](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_33.html#understandlni-CHP-2)
1. [VI. Neighboring                                                   Subsystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_34.html)
    1. [26. Neighboring Subsystem:                                                   Concepts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html)
        1. [26.1.                                                   What Is a Neighbor?](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
        1. [26.2.                                                   Reasons That Neighboring Protocols Are Needed](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.2.1. When L3 Addresses Need to Be Translated                                                   to L2 Addresses](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.2.2. Shared Medium](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.2.3. Why Static Assignment of Addresses Is Not                                                   Sufficient](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.2.4. Special Cases](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.2.5. Solicitation Requests and                                                   Replies](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
        1. [26.3.                                                   Linux Implementation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.3.1. Neighboring Protocols](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
        1. [26.4.                                                   Proxying the Neighboring Protocol](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.4.1. Conditions Required by the Proxy](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
        1. [26.5.                                                   When Solicitation Requests Are Transmitted and                                                   Processed](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
        1. [26.6.                                                   Neighbor States and Network Unreachability                                                   Detection (NUD)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.6.1. Reachability](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.6.2. Transitions Between NUD States](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
                1. [26.6.2.1. Basic states](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
                1. [26.6.2.2. Derived states](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
                1. [26.6.2.3. Initial state](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
            1. [26.6.3. Reachability Confirmation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_35.html#understandlni-CHP-2)
    1. [27. Neighboring Subsystem:                                                   Infrastructure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html)
        1. [27.1.                                                   Main Data Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.2.                                                   Common Interface Between L3 Protocols and                                                   Neighboring Protocols](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.2.1. Initialization of neigh-&gt;ops](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.2.2. Initialization of neigh-&gt;output and                                                   neigh-&gt;nud_state](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.2.2.1. Common state changes: neigh_connect and                                                   neigh_suspect](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.2.2.2. Routines used for                                                   neigh-&gt;output](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.2.3. Updating a Neighbor’s Information:                                                   neigh_update](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.2.3.1. neigh_update optimization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.2.3.2. Initial neigh_update                                                   operations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.2.3.3. Changes of link layer address](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.2.3.4. Notifications to arpd](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.3.                                                   General Tasks of the Neighboring                                                   Infrastructure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.3.1. Caching](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.3.2. Timers](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.4.                                                   Reference Counts on neighbour Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.5.                                                   Creating a neighbour Entry](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.5.1. The neigh_create Function’s                                                   Parameters](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.5.2. Neighbor Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.6.                                                   Neighbor Deletion](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.6.1. Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.6.1.1. Synchronous cleanup: the                                                   neigh_forced_gc function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.6.1.2. Asynchronous cleanup: the                                                   neigh_periodic_timer function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.7.                                                   Acting As a Proxy](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.7.1. Delayed Processing of Solicitation                                                   Requests](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.7.2. Per-Device Proxying and Per-Destination                                                   Proxying](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.8.                                                   L2 Header Caching](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.8.1. Methods Provided by the Device                                                   Driver](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.8.2. Link Between Routing and L2 Header                                                   Caching](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.8.3. Cache Invalidation and Updating](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.9.                                                   Protocol Initialization and Cleanup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.10. Interaction with Other Subsystems](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.10.1. Events Generated by the Neighboring                                                   Layer](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.10.2. Events Received by the Neighboring                                                   Layer](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.10.2.1. Updates via neigh_ifdown](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
                1. [27.10.2.2. Updates via neigh_changeaddr                                                   (netdevice notification chain)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.11. Interaction Between Neighboring Protocols                                                   and L3 Transmission Functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
        1. [27.12. Queuing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.12.1. Ingress Queuing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
            1. [27.12.2. Egress Queuing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_36.html#understandlni-CHP-2)
    1. [28. Neighboring Subsystem:                                                   Address Resolution Protocol (ARP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html)
        1. [28.1.                                                   ARP Packet Format](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.1.1. Destination Address Types for ARP                                                   Packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.2.                                                   Example of an ARP Transaction](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.3.                                                   Gratuitous ARP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.3.1. Change of L2 Address](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.3.2. Duplicate Address Detection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.3.3. Virtual IP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.4.                                                   Responding from Multiple Interfaces](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.5.                                                   Tunable ARP Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.5.1. Compile-Time Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.5.2. /proc Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.5.2.1. ARP_ANNOUNCE](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.5.2.2. ARP_IGNORE](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.5.2.3. ARP_FILTER](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.5.2.4. Medium ID](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.6.                                                   ARP Protocol Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.6.1. The arp_tbl Table](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.7.                                                   Initialization of a neighbour Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.7.1. Basic Initialization Sequence](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.7.2. Virtual Functions in the ops                                                   Field](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.7.3. Start of the arp_constructor                                                   Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.7.4. Devices That Do Not Need ARP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.7.5. Devices That Need ARP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.8.                                                   Transmitting and Receiving ARP Packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.8.1. Transmitting ARP Packets: Introduction to                                                   arp_send](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.8.2. Solicitations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.8.2.1. ARP_ANNOUNCE and selection of source IP                                                   address](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.9.                                                   Processing Ingress ARP Packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.9.1. Initial Common Processing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.9.2. Processing ARPOP_REQUEST Packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.9.2.1. Passive learning and ARP                                                   optimization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
                1. [28.9.2.2. Requests with zero addresses](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.9.3. Processing ARPOP_REPLY Packets](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.9.4. Final Common Processing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.10. Proxy ARP](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.10.1. Destination NAT (DNAT)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.10.2. Proxy ARP Server as Router](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.11. Examples](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.12. External Events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.12.1. Received Events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.12.2. Generated Events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.12.3. Wake-on-LAN Events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.13. ARPD](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.13.1. Kernel Side](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
            1. [28.13.2. User-Space Side](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.14. Reverse Address Resolution Protocol                                                   (RARP)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
        1. [28.15. Improvements in ND (IPv6) over ARP                                                   (IPv4)](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_37.html#understandlni-CHP-2)
    1. [29. Neighboring Subsystem:                                                   Miscellaneous Topics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html)
        1. [29.1.                                                   System Administration of Neighbors](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.1.1. Common Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.1.2. New-Generation Tool: IPROUTE2’s ip                                                   Command](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.1.3. Old-Generation Tool: net-tools’s arp                                                   Command](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
        1. [29.2.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.2.1. The /proc/sys/net/ipv4/neigh                                                   Directory](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
                1. [29.2.1.1. Initialization of global and per-device                                                   directories](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
                1. [29.2.1.2. Directory creation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.2.2. The /proc/sys/net/ipv4/conf                                                   Directory](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
        1. [29.3.                                                   Data Structures Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.1. neighbour Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.2. neigh_table Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.3. neigh_parms Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.4. neigh_ops Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.5. hh_cache Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.6. neigh_statistics Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
            1. [29.3.7. Data Structures Featured in This Part of                                                   the Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
        1. [29.4.                                                   Files and Directories Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_38.html#understandlni-CHP-2)
1. [VII. Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_39.html)
    1. [30. Routing: Concepts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html)
        1. [30.1.                                                   Routers, Routes, and Routing Tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.1.1. Nonrouting Multihomed Hosts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.1.2. Varieties of Routing                                                   Configurations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.1.3. Questions Answered in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
        1. [30.2.                                                   Essential Elements of Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.2.1. Scope](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
                1. [30.2.1.1. Use of the scope](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.2.2. Default Gateway](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.2.3. Directed Broadcasts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.2.4. Primary and Secondary Addresses](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
                1. [30.2.4.1. Old-generation configuration: aliasing                                                   interfaces](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
                1. [30.2.4.2. Relationship between aliasing devices                                                   and primary/secondary status](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
        1. [30.3.                                                   Routing Table](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.3.1. Special Routes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.3.2. Route Types and Actions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.3.3. Routing Cache](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.3.4. Routing Table Versus Routing                                                   Cache](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.3.5. Routing Cache Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
                1. [30.3.5.1. Examples of events that can expire                                                   cache entries](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
                1. [30.3.5.2. Examples of eligible cache                                                   victims](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
        1. [30.4.                                                   Lookups](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
            1. [30.4.1. Longest Prefix Match](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
        1. [30.5.                                                   Packet Reception Versus Packet                                                   Transmission](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_40.html#understandlni-CHP-3)
    1. [31. Routing: Advanced](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html)
        1. [31.1.                                                   Concepts Behind Policy Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.1.1. Lookup with Policy Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.1.2. Routing Table Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
        1. [31.2.                                                   Concepts Behind Multipath Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.2.1. Next Hop Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.2.2. Cache Support for Multipath](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
                1. [31.2.2.1. Weighted random algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
                1. [31.2.2.2. Device round-robin algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.2.3. Per-Flow, Per-Connection, and Per-Packet                                                   Distribution](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
                1. [31.2.3.1. Equalizer algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
        1. [31.3.                                                   Interactions with Other Kernel Subsystems](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.3.1. Routing Table Based Classifier](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
                1. [31.3.1.1. Configuring policy realms](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
                1. [31.3.1.2. Configuring route realms](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
                1. [31.3.1.3. Computing the routing tag](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.3.2. Policy Routing and Firewall-Based                                                   Classifier](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
        1. [31.4.                                                   Routing Protocol Daemons](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
        1. [31.5.                                                   Verbose Monitoring](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
        1. [31.6.                                                   ICMP_REDIRECT Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.6.1. Shared Media](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.6.2. Transmitting ICMP_REDIRECT                                                   Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
            1. [31.6.3. Processing Ingress ICMP_REDIRECT                                                   Messages](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
        1. [31.7.                                                   Reverse Path Filtering](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_41.html#understandlni-CHP-3)
    1. [32. Routing: Li nux                                                   Implementation](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html)
        1. [32.1.                                                   Kernel Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.1.1. Basic Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.1.2. Advanced Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.1.3. Recently Dropped Options](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.2.                                                   Main Data Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.2.1. Lists and Hash Tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.3.                                                   Route and Address Scopes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.3.1. Route Scopes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.3.2. Address Scopes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.3.3. Relationship Between Route and Next-Hop                                                   Scopes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.4.                                                   Primary and Secondary IP Addresses](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.5.                                                   Generic Helper Routines and Macros](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.6.                                                   Global Locks](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.7.                                                   Routing Subsystem Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.8.                                                   External Events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.8.1. Helper Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.8.2. Changes in IP Configuration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
                1. [32.8.2.1. Adding an IP address](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
                1. [32.8.2.2. Removing an IP address](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.8.3. Changes in Device Status](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
                1. [32.8.3.1. Impacts on the routing tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
                1. [32.8.3.2. Impacts on the policy database](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
                1. [32.8.3.3. Impacts on the IP                                                   configuration](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
        1. [32.9.                                                   Interactions with Other Subsystems](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.9.1. Netlink Notifications](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.9.2. Policy Routing and Firewall-Based                                                   Classifier](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
            1. [32.9.3. Routing Protocol Daemons](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_42.html#understandlni-CHP-3)
    1. [33. Routing: The Routing                                                   Cache](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html)
        1. [33.1.                                                   Routing Cache Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.2.                                                   Hash Table Organization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.3.                                                   Major Cache Operations](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.3.1. Cache Locking](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.3.2. Cache Entry Allocation and Reference                                                   Counts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.3.3. Adding Elements to the Cache](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.3.4. Binding the Route Cache to the ARP                                                   Cache](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.3.5. Cache Lookup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
                1. [33.3.5.1. Ingress lookup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
                1. [33.3.5.2. Egress lookup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.4.                                                   Multipath Caching](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.1. Registering a Caching Algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.2. Interface Between the Routing Cache and                                                   Multipath](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.3. Helper Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.4. Common Elements Between                                                   Algorithms](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.5. Random Algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.6. Weighted Random Algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.7. Round-Robin Algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.4.8. Device Round-Robin Algorithm](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.5.                                                   Interface Between the DST and Calling                                                   Protocols](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.5.1. IPsec Transformations and the Use of                                                   dst_entry](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.5.2. External Events](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.6.                                                   Flushing the Routing Cache](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.7.                                                   Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.7.1. Synchronous Cleanup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.7.2. rt_garbage_collect Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.7.3. Asynchronous Cleanup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.7.4. Expiration Criteria](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.7.5. Deleting DST Entries](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
            1. [33.7.6. Variables That Tune and Control Garbage                                                   Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
        1. [33.8.                                                   Egress ICMP REDIRECT Rate Limiting](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_43.html#understandlni-CHP-3)
    1. [34. Routing: Routing                                                   Tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html)
        1. [34.1.                                                   Organization of Routing Hash Tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.1.1. Organization of Per-Netmask Tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
                1. [34.1.1.1. Basic structures for hash table                                                   organization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
                1. [34.1.1.2. Dynamic resizing of per-netmask hash                                                   tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.1.2. Organization of fib_info Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
                1. [34.1.2.1. Dynamic resizing of global hash                                                   tables](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.1.3. Organization of Next-Hop Router                                                   Structures](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.1.4. The Two Default Routing Tables:                                                   ip_fib_main_table and ip_fib_local_table](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
        1. [34.2.                                                   Routing Table Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
        1. [34.3.                                                   Adding and Removing Routes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.3.1. Adding a Route](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.3.2. Deleting a Route](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.3.3. Garbage Collection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
        1. [34.4.                                                   Policy Routing and Its Effects on Routing Table                                                   Definitions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.4.1. Variable and Structure                                                   Definitions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
            1. [34.4.2. Double Definitions for Functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_44.html#understandlni-CHP-3)
    1. [35. Routing: Lookups](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html)
        1. [35.1.                                                   High-Level View of Lookup Functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.2.                                                   Helper Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.3.                                                   The Table Lookup: fn_hash_lookup](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.3.1. Semantic Matching on Subsidiary                                                   Criteria](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
                1. [35.3.1.1. Criteria for rejecting routes](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
                1. [35.3.1.2. Return value from                                                   fib_semantic_match](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.4.                                                   fib_lookup Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.5.                                                   Setting Functions for Reception and                                                   Transmission](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.5.1. Initialization of Function Pointers for                                                   Ingress Traffic](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.5.2. Initialization of Function Pointers for                                                   Egress Traffic](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.5.3. Special Cases](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.6.                                                   General Structure of the Input and Output Routing                                                   Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.7.                                                   Input Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.7.1. Creation of a Cache Entry](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.7.2. Preferred Source Address                                                   Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.7.3. Local Delivery](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.7.4. Forwarding](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.7.5. Routing Failure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.8.                                                   Output Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.1. Search Key Initialization](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.2. Selecting the Source IP Address](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.3. Local Delivery](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.4. Transmission to Other Hosts](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.5. Interaction Between Multipath and Default                                                   Gateway Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.6. Default Gateway Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.8.7. fn_hash_select_default Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.9.                                                   Effects of Multipath on Next Hop Selection](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.9.1. Multipath Caching](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.10. Policy Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.10.1. fib_lookup with Policy Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.10.2. Default Gateway Selection with Policy                                                   Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.11. Source Routing](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
        1. [35.12. Policy Routing and Routing Table Based                                                   Classifier](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.12.1. Storing the Realms](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.12.2. Helper Routines](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
            1. [35.12.3. Computing the Routing Tag](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_45.html#understandlni-CHP-3)
    1. [36. Routing: Miscellaneous                                                   Topics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html)
        1. [36.1.                                                   User-Space Configuration Tools](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.1.1. Configuring Routing with IPROUTE2](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
                1. [36.1.1.1. Correspondence between IPROUTE2 user                                                   commands and kernel functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
                1. [36.1.1.2. inet_rtm_newroute and inet_rtm_delroute                                                   functions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.1.2. Configuring Routing with                                                   net-tools](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.1.3. Change Notifications](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.1.4. Routes Inserted by the Kernel: The                                                   fib_magic Function](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
        1. [36.2.                                                   Statistics](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
        1. [36.3.                                                   Tuning via /proc Filesystem](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.3.1. The /proc/sys/net/ipv4 Directory](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.3.2. The /proc/sys/net/ipv4/route                                                   Directory](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.3.3. The /proc/sys/net/ipv4/conf Directory](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
                1. [36.3.3.1. Special subdirectories](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
                1. [36.3.3.2. Use of the special                                                   subdirectories](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
                1. [36.3.3.3. File descriptions](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.3.4. The /proc/net and /proc/net/stat                                                   Directories](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
        1. [36.4.                                                   Enabling and Disabling Forwarding](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
        1. [36.5.                                                   Data Structures Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.1. fib_table Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.2. fn_zone Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.3. fib_node Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.4. fib_alias Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.5. fib_info Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.6. fib_nh Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.7. fib_rule Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.8. fib_result Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.9. rtable Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.10. dst_entry Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.11. dst_ops Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.12. flowi Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.13. rt_cache_stat Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
            1. [36.5.14. ip_mp_alg_ops Structure](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
        1. [36.6.                                                   Functions and Variables Featured in This Part of                                                   the Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
        1. [36.7.                                                   Files and Directories Featured in This Part of the                                                   Book](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_46.html#understandlni-CHP-3)
1. [About the                                                   Author](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_47.html)
1. [Colophon](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_48.html)
1. [Copyright](https://ebookreading.net/view/book/Understanding+Linux+Network+Internals-EB0596002556_49.html)
