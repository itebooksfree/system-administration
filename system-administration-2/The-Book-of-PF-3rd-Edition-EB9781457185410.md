![Cover image for The Book of PF, 3rd Edition](https://imgdetail.ebookreading.net/cover/cover/system_admin/EB9781457185410.jpg)

[The Book of PF, 3rd Edition](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_1.html "The Book of PF, 3rd Edition")
====================================================================================================================

Author : [Peter N.M. Hansteen](https://ebookreading.net/search/author/Peter+N.M.+Hansteen)

Release Date : 2014/10/01

ISBN : 9781457185410

Topic : [System Administration](https://ebookreading.net/search/category/system-administration)

Book Description
-----------------

The Book of PF is the essential guide to building a secure network with PF, the OpenBSD packet filtering tool.
              
Table of Contents
-----------------

1. [Dedication](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_3.html)
1. [Praise for The Book of PF](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_4.html)
1. [Foreword from the first edition](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_5.html)
1. [Acknowledgments](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_6.html)
1. [Introduction](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_7.html)
    1. [This Is Not a HOWTO](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_7.html#this_is_not_a_howto)
    1. [What This Book Covers](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_7.html#what_this_book_cove)
1. [1. Building the Network you Need](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html)
    1. [Your Network: High Performance, Low Maintenance, and Secure](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#your_network_high_p)
    1. [Where the Packet Filter Fits In](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#where_the_packet_fi)
    1. [The Rise of PF](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#rise_of_pf)
    1. [If You Came from Elsewhere](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#if_you_came_from_el)
        1. [Pointers for Linux Users](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#pointers_for_linux_)
        1. [Frequently Answered Questions About PF](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#frequently_answered)
            1. [Can I run PF on my Linux machine?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#can_i_run_pf_on_my_)
            1. [Can you recommend a GUI tool for managing my PF rule set?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#can_you_recommend_a)
            1. [Is there a tool I can use to convert my OtherProduct&amp;#174; setup to a PF configuration?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#is_there_a_tool_i_c)
            1. [I heard PF is based on IPFilter, which I know from working with Solaris. Can I just copy my IPFilter configuration across and have a working setup right away?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#i_heard_pf_is_based)
            1. [Why did the PF rule syntax change all of a sudden?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#why_did_the_pf_rule)
            1. [Where can I find out more?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#where_can_i_find_ou)
    1. [A Little Encouragement: A PF Haiku](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_8.html#little_encouragemen)
1. [2. PF Configuration Basics](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html)
    1. [The First Step: Enabling PF](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#first_step_enabling)
        1. [Setting Up PF on OpenBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#setting_up_pf_on_op)
        1. [Setting Up PF on FreeBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#setting_up_pf_on_fr)
        1. [Setting Up PF on NetBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#setting_up_pf_on_ne)
    1. [A Simple PF Rule Set: A Single, Stand-Alone Machine](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#simple_pf_rule_set_)
        1. [A Minimal Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#minimal_rule_set)
        1. [Testing the Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#testing_the_rule_se)
    1. [Slightly Stricter: Using Lists and Macros for Readability](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#slightly_stricter_u)
        1. [A Stricter Baseline Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#stricter_baseline_r)
        1. [Reloading the Rule Set and Looking for Errors](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#reloading_the_rule_)
        1. [Checking Your Rules](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#checking_your_rules)
        1. [Testing the Changed Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#testing_the_changed)
    1. [Displaying Information About Your System](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#displaying_informat)
    1. [Looking Ahead](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_9.html#looking_ahead)
1. [3. Into the Real World](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html)
    1. [A Simple Gateway](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#simple_gateway)
        1. [Keep It Simple: Avoid the Pitfalls of in, out, and on](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#keep_it_simple_avoi)
        1. [Network Address Translation vs. IPv6](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#network_address_tra)
        1. [Final Preparations: Defining Your Local Network](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#final_preparations_)
        1. [Setting Up a Gateway](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#setting_up_a_gatewa)
        1. [Testing Your Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#testing_your_rule_s)
    1. [That Sad Old FTP Thing](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#that_sad_old_ftp_th)
        1. [If We Must: ftp-proxy with Divert or Redirect](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#if_we_must_ftp-prox)
        1. [Variations on the ftp-proxy Setup](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#variations_on_the_f)
    1. [Making Your Network Troubleshooting-Friendly](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#making_your_network)
        1. [Do We Let It All Through?](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#do_we_let_it_all_th)
        1. [The Easy Way Out: The Buck Stops Here](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#easy_way_out_the_bu)
        1. [Letting ping Through](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#letting_ping_throug)
        1. [Helping traceroute](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#helping_traceroute)
        1. [Path MTU Discovery](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#path_mtu_discovery)
    1. [Tables Make Your Life Easier](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_10.html#tables_make_your_li)
1. [4. Wireless Networks Made Easy](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html)
    1. [A Little IEEE 802.11 Background](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#little_ieee_802dot1)
        1. [MAC Address Filtering](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#mac_address_filteri)
        1. [WEP](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#wep)
        1. [WPA](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#wpa)
        1. [The Right Hardware for the Task](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#right_hardware_for_)
        1. [Setting Up a Simple Wireless Network](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#setting_up_a_simple)
        1. [An OpenBSD WPA Access Point](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#openbsd_wpa_access_)
        1. [A FreeBSD WPA Access Point](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#freebsd_wpa_access_)
        1. [The Access Point’s PF Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#access_pointapostro)
        1. [Access Points with Three or More Interfaces](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#access_points_with_)
        1. [Handling IPSec, VPN Solutions](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#handling_ipseccomma)
        1. [The Client Side](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#client_side)
        1. [OpenBSD Setup](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#openbsd_setup)
        1. [FreeBSD Setup](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#freebsd_setup)
        1. [Guarding Your Wireless Network with authpf](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#guarding_your_wirel)
        1. [A Basic Authenticating Gateway](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#basic_authenticatin)
        1. [Wide Open but Actually Shut](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_11.html#wide_open_but_actua)
1. [5. Bigger or Trickier Networks](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html)
    1. [A Web Server and Mail Server on the Inside: Routable IPv4 Addresses](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#web_server_and_mail)
        1. [A Degree of Separation: Introducing the DMZ](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#degree_of_separatio)
        1. [Sharing the Load: Redirecting to a Pool of Addresses](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#sharing_the_load_re)
        1. [Getting Load Balancing Right with relayd](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#getting_load_balanc)
    1. [A Web Server and Mail Server on the Inside—The NAT Version](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#web_server_and_mail)
        1. [DMZ with NAT](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#dmz_with_nat)
        1. [Redirection for Load Balancing](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#redirection_for_loa)
        1. [Back to the Single NATed Network](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#back_to_the_single_)
    1. [Filtering on Interface Groups](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#filtering_on_interf)
    1. [The Power of Tags](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#power_of_tags)
    1. [The Bridging Firewall](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#bridging_firewall)
        1. [Basic Bridge Setup on OpenBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#basic_bridge_setup_)
        1. [Basic Bridge Setup on FreeBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#basic_bridge_setup_)
        1. [Basic Bridge Setup on NetBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#basic_bridge_setup_)
        1. [The Bridge Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#bridge_rule_set)
    1. [Handling Nonroutable IPv4 Addresses from Elsewhere](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#handling_nonroutabl)
        1. [Establishing Global Rules](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#establishing_global)
        1. [Restructuring Your Rule Set with Anchors](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#restructuring_your_)
    1. [How Complicated Is Your Network?—Revisited](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_12.html#how_complicated_is_)
1. [6. Turning the Tables for Proactive Defense](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html)
    1. [Turning Away the Brutes](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#turning_away_the_br)
        1. [SSH Brute-Force Attacks](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#ssh_brute-force_att)
        1. [Setting Up an Adaptive Firewall](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#setting_up_an_adapt)
        1. [Tidying Your Tables with pfctl](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#tidying_your_tables)
    1. [Giving Spammers a Hard Time with spamd](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#giving_spammers_a_h)
        1. [Network-Level Behavior Analysis and Blacklisting](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#network-level_behav)
            1. [Setting Up spamd in Blacklisting Mode](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#setting_up_spamd_in)
            1. [spamd Logging](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#spamd_logging)
        1. [Greylisting: My Admin Told Me Not to Talk to Strangers](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#greylisting_my_admi)
            1. [Setting Up spamd in Greylisting Mode](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#setting_up_spamd_in)
            1. [Greylisting in Practice](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#greylisting_in_prac)
        1. [Tracking Your Real Mail Connections: spamlogd](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#tracking_your_real_)
        1. [Greytrapping](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#greytrapping)
        1. [Managing Lists with spamdb](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#managing_lists_with)
            1. [Updating Lists](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#updating_lists)
            1. [Keeping spamd Greylists in Sync](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#keeping_spamd_greyl)
        1. [Detecting Out-of-Order MX Use](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#detecting_out-of-or)
        1. [Handling Sites That Do Not Play Well with Greylisting](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#handling_sites_that)
    1. [Spam-Fighting Tips](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_13.html#spam-fighting_tips)
1. [7. Traffic Shaping with Queues and Priorities](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html)
    1. [Always-On Priority and Queues for Traffic Shaping](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#always-on_priority_)
        1. [Shaping by Setting Traffic Priorities](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#shaping_by_setting_)
            1. [The prio Priority Scheme](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#prio_priority_schem)
            1. [The Two-Priority Speedup Trick](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#two-priority_speedu)
        1. [Introducing Queues for Bandwidth Allocation](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#introducing_queues_)
            1. [The HFSC Algorithm](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#hfsc_algorithm)
            1. [Splitting Your Bandwidth into Fixed-Size Chunks](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#splitting_your_band)
            1. [Queue Definition](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_definition)
            1. [Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#rule_set)
            1. [Upper and Lower Bounds with Bursts](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#upper_and_lower_bou)
            1. [Queue Definition](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_definition-id)
            1. [Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#rule_set-id00003)
            1. [The DMZ Network, Now with Traffic Shaping](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#dmz_networkcomma_no)
        1. [Using Queues to Handle Unwanted Traffic](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#using_queues_to_han)
            1. [Overloading to a Tiny Queue](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#overloading_to_a_ti)
            1. [Queue Assignments Based on Operating System Fingerprint](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_assignments_b)
    1. [Transitioning from ALTQ to Priorities and Queues](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#transitioning_from_)
    1. [Directing Traffic with ALTQ](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#directing_traffic_w)
        1. [Basic ALTQ Concepts](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#basic_altq_concepts)
        1. [Queue Schedulers, aka Queue Disciplines](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_schedulerscom)
            1. [priq](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#priq)
            1. [cbq](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#cbq)
            1. [hfsc](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#hfsc)
        1. [Setting Up ALTQ](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#setting_up_altq)
            1. [ALTQ on OpenBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#altq_on_openbsd)
            1. [ALTQ on FreeBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#altq_on_freebsd)
            1. [ALTQ on NetBSD](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#altq_on_netbsd)
    1. [Priority-Based Queues](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#priority-based_queu)
        1. [Using ALTQ Priority Queues to Improve Performance](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#using_altq_priority)
        1. [Using a match Rule for Queue Assignment](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#using_a_match_rule_)
        1. [Class-Based Bandwidth Allocation for Small Networks](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#class-based_bandwid)
            1. [Queue Definition](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_definition-id)
            1. [Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#rule_set-id00005)
        1. [A Basic HFSC Traffic Shaper](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#basic_hfsc_traffic_)
            1. [Queue Definition](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_definition-id)
            1. [Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#rule_set-id00007)
        1. [Queuing for Servers in a DMZ](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queuing_for_servers)
        1. [Using ALTQ to Handle Unwanted Traffic](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#using_altq_to_handl)
            1. [Overloading to a Tiny Queue](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#overloading_to_a_ti)
            1. [Queue Assignments Based on Operating System Fingerprint](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#queue_assignments_b)
    1. [Conclusion: Traffic Shaping for Fun, and Perhaps Even Profit](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_14.html#conclusion_traffic_)
1. [8. Redundancy and Resource Availability](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html)
    1. [Redundancy and Failover: CARP and pfsync](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#redundancy_and_fail)
        1. [The Project Specification: A Redundant Pair of Gateways](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#project_specificati)
        1. [Setting Up CARP](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#setting_up_carp)
            1. [Checking Kernel Options](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#checking_kernel_opt)
            1. [Setting sysctl Values](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#setting_sysctl_valu)
            1. [Setting Up Network Interfaces with ifconfig](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#setting_up_network_)
        1. [Keeping States Synchronized: Adding pfsync](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#keeping_states_sync)
        1. [Putting Together a Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#putting_together_a_)
        1. [CARP for Load Balancing](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#carp_for_load_balan)
            1. [CARP in Load-Balancing Mode](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#carp_in_load-balanc)
            1. [Setting Up CARP Load Balancing](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_15.html#setting_up_carp_loa)
1. [9. Logging, Monitoring, and Statistics](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html)
    1. [PF Logs: The Basics](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#pf_logs_the_basics)
        1. [Logging the Packet’s Path Through Your Rule Set: log (matches)](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#logging_the_packeta)
        1. [Logging All Packets: log (all)](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#logging_all_packets)
        1. [Logging to Several pflog Interfaces](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#logging_to_several_)
        1. [Logging to syslog, Local or Remote](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#logging_to_syslogco)
        1. [Tracking Statistics for Each Rule with Labels](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#tracking_statistics)
        1. [Additional Tools for PF Logs and Statistics](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#additional_tools_fo)
        1. [Keeping an Eye on Things with systat](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#keeping_an_eye_on_t)
        1. [Keeping an Eye on Things with pftop](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#keeping_an_eye_on_t)
        1. [Graphing Your Traffic with pfstat](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#graphing_your_traff)
        1. [Collecting NetFlow Data with pflow(4)](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#collecting_netflow_)
            1. [Setting Up the NetFlow Sensor](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#setting_up_the_netf)
            1. [NetFlow Data Collecting, Reporting, and Analysis](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#netflow_data_collec)
        1. [Collecting NetFlow Data with pfflowd](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#collecting_netflow_)
        1. [SNMP Tools and PF-Related SNMP MIBs](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#snmp_tools_and_pf-r)
    1. [Log Data as the Basis for Effective Debugging](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_16.html#log_data_as_the_bas)
1. [10. Getting Your Setup Just Right](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html)
    1. [Things You Can Tweak and What You Probably Should Leave Alone](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#things_you_can_twea)
        1. [Block Policy](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#block_policy)
        1. [Skip Interfaces](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#skip_interfaces)
        1. [State Policy](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#state_policy)
        1. [State Defaults](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#state_defaults)
        1. [Timeouts](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#timeouts)
        1. [Limits](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#limits)
        1. [Debug](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#debug)
        1. [Rule Set Optimization](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#rule_set_optimizati)
        1. [Optimization](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#optimization)
        1. [Fragment Reassembly](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#fragment_reassembly)
    1. [Cleaning Up Your Traffic](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#cleaning_up_your_tr)
        1. [Packet Normalization with scrub: OpenBSD 4.5 and Earlier](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#packet_normalizatio)
        1. [Packet Normalization with scrub: OpenBSD 4.6 Onward](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#packet_normalizatio)
        1. [Protecting Against Spoofing with antispoof](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#protecting_against_)
    1. [Testing Your Setup](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#testing_your_setup)
    1. [Debugging Your Rule Set](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#debugging_your_rule)
    1. [Know Your Network and Stay in Control](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_17.html#know_your_network_a)
1. [A. Resources](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html)
    1. [General Networking and BSD Resources on the Internet](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#general_networking_)
    1. [Sample Configurations and Related Musings](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#sample_configuratio)
    1. [PF on Other BSD Systems](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#pf_on_other_bsd_sys)
    1. [BSD and Networking Books](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#bsd_and_networking_)
    1. [Wireless Networking Resources](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#wireless_networking)
    1. [spamd and Greylisting-Related Resources](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#spamd_and_greylisti)
    1. [Book-Related Web Resources](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#book-drelated_web_r)
    1. [Buy OpenBSD CDs and Donate!](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_18.html#buy_openbsd_cds_and)
1. [B. A Note On Hardware Support](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_19.html)
    1. [Getting the Right Hardware](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_19.html#getting_the_right_h)
    1. [Issues Facing Hardware Support Developers](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_19.html#issues_facing_hardw)
    1. [How to Help the Hardware Support Efforts](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_19.html#how_to_help_the_har)
1. [Index](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_20.html)
1. [About the Author](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_21.html)
1. [Copyright](https://ebookreading.net/view/book/The+Book+of+PF%2C+3rd+Edition-EB9781457185410_22.html)
